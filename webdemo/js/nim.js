!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):"object"==typeof exports?exports.NIM=t():e.NIM=t()}(this,function(){return function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function o(e){d.verifyOptions(e,"appKey account token"),y.setDebug(e.debug),d.verifyCallback(e,"onconnect onkicked onerror ondisconnect onloginportschange onteams onroamingmsgs onofflinemsgs onofflinesysmsgs onsyncdone onteammembers onsyncteammembersdone onmsg onsysmsg oncustomsysmsg oncreateteam onupdateteammember"),this.options=d.copy(e),this.socket=new i(e)}function r(e,t,n){e.done(t,n||e.callback.options)}n(2),n(3);var i=n(4),s=n(5),a=n(19),c=n(15),p=n(20),l=n(1),u=n(29),d=n(6),f=(n(33),n(7)),m=n(21),y=n(12);o.version=m.version,o.prototype.isConnected=function(){return this.socket.connected},o.prototype.connect=function(){this.socket.connectViaLbs()},o.prototype.disconnect=function(){this.socket.logout()},o.prototype.kick=function(e){d.verifyOptions(e,"deviceIds"),this.processCallback(e),this.socket.kick(e)},o.prototype.sendText=function(e){return d.verifyOptions(e,"scene to text"),d.verifyParamValid("scene",e.scene,s.validScenes()),e.type="text",this.processCallback(e),e.msg=new s.TextMessage(e),this.doSendMsg(e),e.msg.idClient},o.prototype.previewFile=function(e){if(d.verifyOptions(e,"fileInput done"),e.type||(e.type="file"),e.fileInput=d.verifyFileInput(e.fileInput),e.fileInput.files&&!e.fileInput.files.length)return void e.done(f.newNoFileError("请选择"+e.type+"文件后再预览"),e);this.processCallback(e);var t=l.genResponseBody(e.type)||{};this.socket.getNosToken({responseBody:JSON.stringify(t).replace(/\"/gi,'\\"'),callback:function(t,n){if(t)return void e.done(t,e.callback.options);var o=e.uploaddone;e.uploaddone=function(t,n){if(t)return t.appendMessage("上传文件失败"),void e.done(t,e.callback.options);n=l.parseResponse(n),n.url=e.url+"/"+e.params.Object,n.name=d.getFileName(e.fileInput);var r=n.name.lastIndexOf(".");return n.ext=-1===r?"unknown":n.name.slice(r+1),e.uploaddone=o,void e.done(null,d.copy(n))},e.url=m.fileServerUrl+n.bucket,e.params=this.assembleUploadParams(n),e.fileName="file";new u(e)}.bind(this)})},o.prototype.sendFile=function(e){if(d.verifyOptions(e,"scene to done"),d.verifyParamValid("scene",e.scene,s.validScenes()),e.type||(e.type="file"),!e.fileInput&&!e.file)throw f.newParamError("参数fileInput和file必须至少提供一个");if(e.fileInput&&e.file)throw f.newParamError("参数fileInput和file必须只能提供一个");if(this.processCallback(e),e.fileInput){if(e.fileInput=d.verifyFileInput(e.fileInput),e.fileInput.files&&!e.fileInput.files.length)return void e.done(f.newNoFileError("请选择"+e.type+"文件后再发送"),e.callback.options);d.verifyCallback(e,"uploaddone beforesend");var t=e.done;e.done=function(n,o){n?t(n,e.callback.options):(e.uploaddone(null,d.copy(o)),e.file=o,e.msg=new s.FileMessage(e),e.beforesend(e.msg.idClient),e.done=t,this.doSendMsg(e))}.bind(this),this.previewFile(e)}return e.file?(e.msg=new s.FileMessage(e),this.doSendMsg(e),e.msg.idClient):void 0},o.prototype.assembleUploadParams=function(e){return e?{Object:decodeURIComponent(e.objectName),"x-nos-token":e.token,"x-nos-entity-type":"json"}:null},o.prototype.sendGeo=function(e){return d.verifyOptions(e,"scene to geo done"),d.verifyParamValid("scene",e.scene,s.validScenes()),e.type="geo",this.processCallback(e),e.msg=new s.GeoMessage(e),this.doSendMsg(e),e.msg.idClient},o.prototype.sendCustomMsg=function(e){return d.verifyOptions(e,"scene to content"),d.verifyParamValid("scene",e.scene,s.validScenes()),d.verifyParamType("content",e.content,"string"),e.type="custom",this.processCallback(e),e.msg=new s.CustomMessage(e),this.doSendMsg(e),e.msg.idClient},o.prototype.doSendMsg=function(e){e.callback.options.idClient=e.msg.idClient,this.socket.sendMsg(e)},o.prototype.sendCustomSysMsg=function(e){return d.verifyOptions(e,"scene to content"),d.verifyParamValid("scene",e.scene,s.validScenes()),"undefined"!=typeof e.sendToOnlineUsersOnly?d.verifyParamType("sendToOnlineUsersOnly",e.sendToOnlineUsersOnly,"boolean"):e.sendToOnlineUsersOnly=!0,this.processCallback(e),e.type="p2p"===e.scene?"customP2p":"customTeam",e.sysMsg=new a.SystemMessage(e),this.socket.sendCustomSysMsg(e),e.sysMsg.idClient},o.prototype.getHistoryMsgs=function(e){d.verifyOptions(e,"scene to"),d.verifyParamValid("scene",e.scene,s.validScenes()),"undefined"==typeof e.beginTime&&(e.beginTime=0),d.verifyParamType("beginTime",e.beginTime,"number"),"undefined"==typeof e.endTime&&(e.endTime=0),d.verifyParamType("endTime",e.endTime,"number"),"undefined"==typeof e.lastMsgId&&(e.lastMsgId=0),d.verifyParamType("lastMsgId",e.lastMsgId,"number"),"undefined"==typeof e.limit&&(e.limit=100),d.verifyParamType("limit",e.limit,"number"),d.verifyParamMax("limit",e.limit,100),"undefined"!=typeof e.reverse?d.verifyParamType("reverse",e.reverse,"boolean"):e.reverse=!1,this.processCallback(e),this.socket.getHistoryMsgs(e)},o.prototype.searchHistoryMsgs=function(e){d.verifyOptions(e,"scene to keyword"),d.verifyParamValid("scene",e.scene,s.validScenes()),"undefined"==typeof e.beginTime&&(e.beginTime=0),d.verifyParamType("beginTime",e.beginTime,"number"),"undefined"==typeof e.endTime&&(e.endTime=0),d.verifyParamType("endTime",e.endTime,"number"),"undefined"==typeof e.limit&&(e.limit=100),d.verifyParamType("limit",e.limit,"number"),d.verifyParamMax("limit",e.limit,100),"undefined"!=typeof e.reverse?d.verifyParamType("reverse",e.reverse,"boolean"):e.reverse=!1,this.processCallback(e),this.socket.searchHistoryMsgs(e)},o.prototype.createTeam=function(e){d.verifyOptions(e,"type name accounts"),d.verifyParamType("accounts",e.accounts,"array"),e.action="create",this.processPs(e),this.processCallback(e),e.team=new c.Team(e),this.socket.createTeam(e)},o.prototype.updateTeam=function(e){d.verifyOptions(e,"teamId"),e.action="update",this.processCallback(e),e.team=new c.Team(e),this.socket.updateTeam(e)},o.prototype.addMembers=function(e){d.verifyOptions(e,"teamId accounts"),d.verifyParamType("accounts",e.accounts,"array"),this.processPs(e),this.processCallback(e),this.socket.addMembers(e)},o.prototype.removeMembers=function(e){d.verifyOptions(e,"teamId accounts"),d.verifyParamType("accounts",e.accounts,"array"),this.processCallback(e),this.socket.removeMembers(e)},o.prototype.acceptInvite=function(e){d.verifyOptions(e,"teamId from"),this.processCallback(e),this.socket.acceptInvite(e)},o.prototype.rejectInvite=function(e){d.verifyOptions(e,"teamId from"),this.processPs(e),this.processCallback(e),this.socket.rejectInvite(e)},o.prototype.applyTeam=function(e){d.verifyOptions(e,"teamId"),this.processPs(e),this.processCallback(e),this.socket.applyTeam(e)},o.prototype.passApply=function(e){d.verifyOptions(e,"teamId from"),this.processCallback(e),this.socket.passApply(e)},o.prototype.rejectApply=function(e){d.verifyOptions(e,"teamId from"),this.processPs(e),this.processCallback(e),this.socket.rejectApply(e)},o.prototype.leaveTeam=function(e){d.verifyOptions(e,"teamId"),this.processCallback(e),this.socket.leaveTeam(e)},o.prototype.addManagers=function(e){d.verifyOptions(e,"teamId accounts"),d.verifyParamType("accounts",e.accounts,"array"),this.processCallback(e),this.socket.addManagers(e)},o.prototype.removeManagers=function(e){d.verifyOptions(e,"teamId accounts"),d.verifyParamType("accounts",e.accounts,"array"),this.processCallback(e),this.socket.removeManagers(e)},o.prototype.transferTeam=function(e){d.verifyOptions(e,"teamId account leave"),d.verifyParamType("leave",e.leave,"boolean"),this.processCallback(e),this.socket.transferTeam(e)},o.prototype.dismissTeam=function(e){d.verifyOptions(e,"teamId"),this.processCallback(e),this.socket.dismissTeam(e)},o.prototype.updateInfoInTeam=function(e){d.verifyOptions(e,"teamId"),this.processCallback(e),e.teamMember=new p.TeamMember(e),this.socket.updateInfoInTeam(e)},o.prototype.updateNickInTeam=function(e){d.verifyOptions(e,"teamId account nickInTeam"),this.processCallback(e),this.socket.updateNickInTeam(e)},o.prototype.getTeam=function(e){d.verifyOptions(e,"teamId"),this.processCallback(e),this.socket.getTeam(e)},o.prototype.getTeams=function(e){this.processCallback(e),this.socket.getTeams(e)},o.prototype.getTeamMembers=function(e){d.verifyOptions(e,"teamId"),this.processCallback(e),this.socket.getTeamMembers(e)},o.prototype.processCallback=function(e){d.verifyOptions(e,"done"),d.verifyCallback(e,"done"),e.callback=r.bind(this,e),e.callback.options=d.copy(e)},o.prototype.processPs=function(e){"undefined"==typeof e.ps&&(e.ps="")},e.exports=o},function(e,t){"use strict";var n={file:{md5:"$(Etag)",size:"$(ObjectSize)"},image:{md5:"$(Etag)",size:"$(ObjectSize)",w:"$(ImageInfo.Width)",h:"$(ImageInfo.Height)"},audio:{md5:"$(Etag)",size:"$(ObjectSize)",dur:"$(AVinfo.Audio.Duration)"},video:{md5:"$(Etag)",size:"$(ObjectSize)",dur:"$(AVinfo.Video.Duration)",w:"$(AVinfo.Video.Width)",h:"$(AVinfo.Video.Height)"}},o={};o.genResponseBody=function(e){return e=e||"file",n[e]},o.parseResponse=function(e){return"undefined"!=typeof e.size&&(e.size=+e.size),"undefined"!=typeof e.w&&(e.w=+e.w),"undefined"!=typeof e.h&&(e.h=+e.h),"undefined"!=typeof e.dur&&(e.dur=+e.dur),e},e.exports=o},function(e,t,n){var o,r;!function(i,s){"use strict";o=s,r="function"==typeof o?o.call(t,n,t,e):o,!(void 0!==r&&(e.exports=r))}(this,function(){function e(e){var t=typeof e;return null===e||"undefined"===t||"boolean"===t||"number"===t||"string"===t}var t,n=Array.prototype,o=Object.prototype,r=Function.prototype,i=String.prototype,s=Number.prototype,a=n.slice,c=n.splice,p=n.push,l=n.unshift,u=r.call,d=o.toString,f=Array.isArray||function(e){return"[object Array]"===d.call(e)},m="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,y=Function.prototype.toString,h=function(e){try{return y.call(e),!0}catch(t){return!1}},v="[object Function]",b="[object GeneratorFunction]";t=function(e){if("function"!=typeof e)return!1;if(m)return h(e);var t=d.call(e);return t===v||t===b};var g,k=RegExp.prototype.exec,T=function(e){try{return k.call(e),!0}catch(t){return!1}},w="[object RegExp]";g=function(e){return"object"!=typeof e?!1:m?T(e):d.call(e)===w};var S,O=String.prototype.valueOf,M=function(e){try{return O.call(e),!0}catch(t){return!1}},I="[object String]";S=function(e){return"string"==typeof e?!0:"object"!=typeof e?!1:m?M(e):d.call(e)===I};var C=function(e){var n=d.call(e),o="[object Arguments]"===n;return o||(o=!f(e)&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&t(e.callee)),o},x=function(e){var t,n=Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch(e){return!1}}();return t=n?function(e,t,n,o){!o&&t in e||Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:n})}:function(e,t,n,o){!o&&t in e||(e[t]=n)},function(n,o,r){for(var i in o)e.call(o,i)&&t(n,i,o[i],r)}}(o.hasOwnProperty),E={ToInteger:function(e){var t=+e;return t!==t?t=0:0!==t&&t!==1/0&&t!==-(1/0)&&(t=(t>0||-1)*Math.floor(Math.abs(t))),t},ToPrimitive:function(n){var o,r,i;if(e(n))return n;if(r=n.valueOf,t(r)&&(o=r.call(n),e(o)))return o;if(i=n.toString,t(i)&&(o=i.call(n),e(o)))return o;throw new TypeError},ToObject:function(e){if(null==e)throw new TypeError("can't convert "+e+" to object");return Object(e)},ToUint32:function(e){return e>>>0}},_=function(){};x(r,{bind:function(e){var n=this;if(!t(n))throw new TypeError("Function.prototype.bind called on incompatible "+n);for(var o,r=a.call(arguments,1),i=function(){if(this instanceof o){var t=n.apply(this,r.concat(a.call(arguments)));return Object(t)===t?t:this}return n.apply(e,r.concat(a.call(arguments)))},s=Math.max(0,n.length-r.length),c=[],p=0;s>p;p++)c.push("$"+p);return o=Function("binder","return function ("+c.join(",")+"){ return binder.apply(this, arguments); }")(i),n.prototype&&(_.prototype=n.prototype,o.prototype=new _,_.prototype=null),o}});var j=u.bind(o.hasOwnProperty),A=function(){var e=[1,2],t=e.splice();return 2===e.length&&f(t)&&0===t.length}();x(n,{splice:function(e,t){return 0===arguments.length?[]:c.apply(this,arguments)}},!A);var P=function(){var e={};return n.splice.call(e,0,0,1),1===e.length}();x(n,{splice:function(e,t){if(0===arguments.length)return[];var n=arguments;return this.length=Math.max(E.ToInteger(this.length),0),arguments.length>0&&"number"!=typeof t&&(n=a.call(arguments),n.length<2?n.push(this.length-e):n[1]=E.ToInteger(t)),c.apply(this,n)}},!P);var N=1!==[].unshift(0);x(n,{unshift:function(){return l.apply(this,arguments),this.length}},N),x(Array,{isArray:f});var R=Object("a"),D="a"!==R[0]||!(0 in R),W=function(e){var t=!0,n=!0;return e&&(e.call("foo",function(e,n,o){"object"!=typeof o&&(t=!1)}),e.call([1],function(){"use strict";n="string"==typeof this},"x")),!!e&&t&&n};x(n,{forEach:function(e){var n=E.ToObject(this),o=D&&S(this)?this.split(""):n,r=arguments[1],i=-1,s=o.length>>>0;if(!t(e))throw new TypeError;for(;++i<s;)i in o&&e.call(r,o[i],i,n)}},!W(n.forEach)),x(n,{map:function(e){var n=E.ToObject(this),o=D&&S(this)?this.split(""):n,r=o.length>>>0,i=Array(r),s=arguments[1];if(!t(e))throw new TypeError(e+" is not a function");for(var a=0;r>a;a++)a in o&&(i[a]=e.call(s,o[a],a,n));return i}},!W(n.map)),x(n,{filter:function(e){var n,o=E.ToObject(this),r=D&&S(this)?this.split(""):o,i=r.length>>>0,s=[],a=arguments[1];if(!t(e))throw new TypeError(e+" is not a function");for(var c=0;i>c;c++)c in r&&(n=r[c],e.call(a,n,c,o)&&s.push(n));return s}},!W(n.filter)),x(n,{every:function(e){var n=E.ToObject(this),o=D&&S(this)?this.split(""):n,r=o.length>>>0,i=arguments[1];if(!t(e))throw new TypeError(e+" is not a function");for(var s=0;r>s;s++)if(s in o&&!e.call(i,o[s],s,n))return!1;return!0}},!W(n.every)),x(n,{some:function(e){var n=E.ToObject(this),o=D&&S(this)?this.split(""):n,r=o.length>>>0,i=arguments[1];if(!t(e))throw new TypeError(e+" is not a function");for(var s=0;r>s;s++)if(s in o&&e.call(i,o[s],s,n))return!0;return!1}},!W(n.some));var F=!1;n.reduce&&(F="object"==typeof n.reduce.call("es5",function(e,t,n,o){return o})),x(n,{reduce:function(e){var n=E.ToObject(this),o=D&&S(this)?this.split(""):n,r=o.length>>>0;if(!t(e))throw new TypeError(e+" is not a function");if(!r&&1===arguments.length)throw new TypeError("reduce of empty array with no initial value");var i,s=0;if(arguments.length>=2)i=arguments[1];else for(;;){if(s in o){i=o[s++];break}if(++s>=r)throw new TypeError("reduce of empty array with no initial value")}for(;r>s;s++)s in o&&(i=e.call(void 0,i,o[s],s,n));return i}},!F);var L=!1;n.reduceRight&&(L="object"==typeof n.reduceRight.call("es5",function(e,t,n,o){return o})),x(n,{reduceRight:function(e){var n=E.ToObject(this),o=D&&S(this)?this.split(""):n,r=o.length>>>0;if(!t(e))throw new TypeError(e+" is not a function");if(!r&&1===arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var i,s=r-1;if(arguments.length>=2)i=arguments[1];else for(;;){if(s in o){i=o[s--];break}if(--s<0)throw new TypeError("reduceRight of empty array with no initial value")}if(0>s)return i;do s in o&&(i=e.call(void 0,i,o[s],s,n));while(s--);return i}},!L);var B=Array.prototype.indexOf&&-1!==[0,1].indexOf(1,2);x(n,{indexOf:function(e){var t=D&&S(this)?this.split(""):E.ToObject(this),n=t.length>>>0;if(!n)return-1;var o=0;for(arguments.length>1&&(o=E.ToInteger(arguments[1])),o=o>=0?o:Math.max(0,n+o);n>o;o++)if(o in t&&t[o]===e)return o;return-1}},B);var U=Array.prototype.lastIndexOf&&-1!==[0,1].lastIndexOf(0,-3);x(n,{lastIndexOf:function(e){var t=D&&S(this)?this.split(""):E.ToObject(this),n=t.length>>>0;if(!n)return-1;var o=n-1;for(arguments.length>1&&(o=Math.min(o,E.ToInteger(arguments[1]))),o=o>=0?o:n-Math.abs(o);o>=0;o--)if(o in t&&e===t[o])return o;return-1}},U);var $=!{toString:null}.propertyIsEnumerable("toString"),H=function(){}.propertyIsEnumerable("prototype"),X=!j("x","0"),q=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],V=q.length;x(Object,{keys:function(e){var n=t(e),o=C(e),r=null!==e&&"object"==typeof e,i=r&&S(e);if(!r&&!n&&!o)throw new TypeError("Object.keys called on a non-object");var s=[],a=H&&n;if(i&&X||o)for(var c=0;c<e.length;++c)s.push(String(c));if(!o)for(var p in e)a&&"prototype"===p||!j(e,p)||s.push(String(p));if($)for(var l=e.constructor,u=l&&l.prototype===e,d=0;V>d;d++){var f=q[d];u&&"constructor"===f||!j(e,f)||s.push(f)}return s}});var z=Object.keys&&function(){return 2===Object.keys(arguments).length}(1,2),J=Object.keys;x(Object,{keys:function(e){return J(C(e)?n.slice.call(e):e)}},!z);var K=-621987552e5,G="-000001",Z=Date.prototype.toISOString&&-1===new Date(K).toISOString().indexOf(G);x(Date.prototype,{toISOString:function(){var e,t,n,o,r;if(!isFinite(this))throw new RangeError("Date.prototype.toISOString called on non-finite value.");for(o=this.getUTCFullYear(),r=this.getUTCMonth(),o+=Math.floor(r/12),r=(r%12+12)%12,e=[r+1,this.getUTCDate(),this.getUTCHours(),this.getUTCMinutes(),this.getUTCSeconds()],o=(0>o?"-":o>9999?"+":"")+("00000"+Math.abs(o)).slice(o>=0&&9999>=o?-4:-6),t=e.length;t--;)n=e[t],10>n&&(e[t]="0"+n);return o+"-"+e.slice(0,2).join("-")+"T"+e.slice(2).join(":")+"."+("000"+this.getUTCMilliseconds()).slice(-3)+"Z"}},Z);var Q=function(){try{return Date.prototype.toJSON&&null===new Date(0/0).toJSON()&&-1!==new Date(K).toJSON().indexOf(G)&&Date.prototype.toJSON.call({toISOString:function(){return!0}})}catch(e){return!1}}();Q||(Date.prototype.toJSON=function(e){var n=Object(this),o=E.ToPrimitive(n);if("number"==typeof o&&!isFinite(o))return null;var r=n.toISOString;if(!t(r))throw new TypeError("toISOString property is not callable");return r.call(n)});var Y=1e15===Date.parse("+033658-09-27T01:46:40.000Z"),ee=!isNaN(Date.parse("2012-04-04T24:00:00.500Z"))||!isNaN(Date.parse("2012-11-31T23:59:59.000Z")),te=isNaN(Date.parse("2000-01-01T00:00:00.000Z"));(!Date.parse||te||ee||!Y)&&(Date=function(e){function t(n,o,r,i,s,a,c){var p=arguments.length;if(this instanceof e){var l=1===p&&String(n)===n?new e(t.parse(n)):p>=7?new e(n,o,r,i,s,a,c):p>=6?new e(n,o,r,i,s,a):p>=5?new e(n,o,r,i,s):p>=4?new e(n,o,r,i):p>=3?new e(n,o,r):p>=2?new e(n,o):p>=1?new e(n):new e;return x(l,{constructor:t},!0),l}return e.apply(this,arguments)}function n(e,t){var n=t>1?1:0;return i[t]+Math.floor((e-1969+n)/4)-Math.floor((e-1901+n)/100)+Math.floor((e-1601+n)/400)+365*(e-1970)}function o(t){return Number(new e(1970,0,1,0,0,0,t))}var r=new RegExp("^(\\d{4}|[+-]\\d{6})(?:-(\\d{2})(?:-(\\d{2})(?:T(\\d{2}):(\\d{2})(?::(\\d{2})(?:(\\.\\d{1,}))?)?(Z|(?:([-+])(\\d{2}):(\\d{2})))?)?)?)?$"),i=[0,31,59,90,120,151,181,212,243,273,304,334,365];for(var s in e)t[s]=e[s];return t.now=e.now,t.UTC=e.UTC,t.prototype=e.prototype,t.prototype.constructor=t,t.parse=function(t){var i=r.exec(t);if(i){var s,a=Number(i[1]),c=Number(i[2]||1)-1,p=Number(i[3]||1)-1,l=Number(i[4]||0),u=Number(i[5]||0),d=Number(i[6]||0),f=Math.floor(1e3*Number(i[7]||0)),m=Boolean(i[4]&&!i[8]),y="-"===i[9]?1:-1,h=Number(i[10]||0),v=Number(i[11]||0);return(u>0||d>0||f>0?24:25)>l&&60>u&&60>d&&1e3>f&&c>-1&&12>c&&24>h&&60>v&&p>-1&&p<n(a,c+1)-n(a,c)&&(s=60*(24*(n(a,c)+p)+l+h*y),s=1e3*(60*(s+u+v*y)+d)+f,m&&(s=o(s)),s>=-864e13&&864e13>=s)?s:0/0}return e.parse.apply(this,arguments)},t}(Date)),Date.now||(Date.now=function(){return(new Date).getTime()});var ne=s.toFixed&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==0xde0b6b3a7640080.toFixed(0)),oe={base:1e7,size:6,data:[0,0,0,0,0,0],multiply:function(e,t){for(var n=-1,o=t;++n<oe.size;)o+=e*oe.data[n],oe.data[n]=o%oe.base,o=Math.floor(o/oe.base)},divide:function(e){for(var t=oe.size,n=0;--t>=0;)n+=oe.data[t],oe.data[t]=Math.floor(n/e),n=n%e*oe.base},numToString:function(){for(var e=oe.size,t="";--e>=0;)if(""!==t||0===e||0!==oe.data[e]){var n=String(oe.data[e]);""===t?t=n:t+="0000000".slice(0,7-n.length)+n}return t},pow:function ye(e,t,n){return 0===t?n:t%2===1?ye(e,t-1,n*e):ye(e*e,t/2,n)},log:function(e){for(var t=0,n=e;n>=4096;)t+=12,n/=4096;for(;n>=2;)t+=1,n/=2;return t}};x(s,{toFixed:function(e){var t,n,o,r,i,s,a,c;if(t=Number(e),t=t!==t?0:Math.floor(t),0>t||t>20)throw new RangeError("Number.toFixed called with invalid number of decimals");if(n=Number(this),n!==n)return"NaN";if(-1e21>=n||n>=1e21)return String(n);if(o="",0>n&&(o="-",n=-n),r="0",n>1e-21)if(i=oe.log(n*oe.pow(2,69,1))-69,s=0>i?n*oe.pow(2,-i,1):n/oe.pow(2,i,1),s*=4503599627370496,i=52-i,i>0){for(oe.multiply(0,s),a=t;a>=7;)oe.multiply(1e7,0),a-=7;for(oe.multiply(oe.pow(10,a,1),0),a=i-1;a>=23;)oe.divide(1<<23),a-=23;oe.divide(1<<a),oe.multiply(1,1),oe.divide(2),r=oe.numToString()}else oe.multiply(0,s),oe.multiply(1<<-i,0),r=oe.numToString()+"0.00000000000000000000".slice(2,2+t);return t>0?(c=r.length,r=t>=c?o+"0.0000000000000000000".slice(0,t-c+2)+r:o+r.slice(0,c-t)+"."+r.slice(c-t)):r=o+r,r}},ne);var re=i.split;2!=="ab".split(/(?:ab)*/).length||4!==".".split(/(.?)(.?)/).length||"t"==="tesst".split(/(s)*/)[1]||4!=="test".split(/(?:)/,-1).length||"".split(/.?/).length||".".split(/()()/).length>1?!function(){var e="undefined"==typeof/()??/.exec("")[1];i.split=function(t,n){var o=this;if("undefined"==typeof t&&0===n)return[];if(!g(t))return re.call(this,t,n);var r,i,s,a,c=[],l=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.extended?"x":"")+(t.sticky?"y":""),u=0,d=new RegExp(t.source,l+"g");o+="",e||(r=new RegExp("^"+d.source+"$(?!\\s)",l));var f="undefined"==typeof n?-1>>>0:E.ToUint32(n);for(i=d.exec(o);i&&(s=i.index+i[0].length,!(s>u&&(c.push(o.slice(u,i.index)),!e&&i.length>1&&i[0].replace(r,function(){for(var e=1;e<arguments.length-2;e++)"undefined"==typeof arguments[e]&&(i[e]=void 0)}),i.length>1&&i.index<o.length&&p.apply(c,i.slice(1)),a=i[0].length,u=s,c.length>=f)));)d.lastIndex===i.index&&d.lastIndex++,i=d.exec(o);return u===o.length?(a||!d.test(""))&&c.push(""):c.push(o.slice(u)),c.length>f?c.slice(0,f):c}}():"0".split(void 0,0).length&&(i.split=function(e,t){return"undefined"==typeof e&&0===t?[]:re.call(this,e,t)});var ie=i.replace,se=function(){var e=[];return"x".replace(/x(.)?/g,function(t,n){e.push(n)}),1===e.length&&"undefined"==typeof e[0]}();se||(i.replace=function(e,n){var o=t(n),r=g(e)&&/\)[*?]/.test(e.source);if(o&&r){var i=function(t){var o=arguments.length,r=e.lastIndex;e.lastIndex=0;var i=e.exec(t)||[];return e.lastIndex=r,i.push(arguments[o-2],arguments[o-1]),n.apply(this,i)};return ie.call(this,e,i)}return ie.call(this,e,n)});var ae=i.substr,ce="".substr&&"b"!=="0b".substr(-1);x(i,{substr:function(e,t){var n=e;return 0>e&&(n=Math.max(this.length+e,0)),ae.call(this,n,t)}},ce);var pe="	\n\f\r   ᠎             　\u2028\u2029\ufeff",le="​",ue="["+pe+"]",de=new RegExp("^"+ue+ue+"*"),fe=new RegExp(ue+ue+"*$"),me=i.trim&&(pe.trim()||!le.trim());x(i,{trim:function(){if("undefined"==typeof this||null===this)throw new TypeError("can't convert "+this+" to object");return String(this).replace(de,"").replace(fe,"")}},me),(8!==parseInt(pe+"08")||22!==parseInt(pe+"0x16"))&&(parseInt=function(e){var t=/^0[xX]/;return function(n,o){var r=String(n).trim(),i=Number(o)||(t.test(r)?16:10);return e(r,i)}}(parseInt))})},function(e,t,n){var o,r;!function(i,s){"use strict";o=s,r="function"==typeof o?o.call(t,n,t,e):o,!(void 0!==r&&(e.exports=r))}(this,function(){function e(e){try{return e.sentinel=0,0===Object.getOwnPropertyDescriptor(e,"sentinel").value}catch(t){return!1}}function t(e){try{return Object.defineProperty(e,"sentinel",{}),"sentinel"in e}catch(t){return!1}}var n,o,r,i,s=Function.prototype.call,a=Object.prototype,c=s.bind(a.hasOwnProperty),p=c(a,"__defineGetter__");if(p&&(n=s.bind(a.__defineGetter__),o=s.bind(a.__defineSetter__),r=s.bind(a.__lookupGetter__),i=s.bind(a.__lookupSetter__)),Object.getPrototypeOf||(Object.getPrototypeOf=function(e){var t=e.__proto__;return t||null===t?t:e.constructor?e.constructor.prototype:a}),Object.defineProperty){var l=e({}),u="undefined"==typeof document||e(document.createElement("div"));if(!u||!l)var d=Object.getOwnPropertyDescriptor}if(!Object.getOwnPropertyDescriptor||d){var f="Object.getOwnPropertyDescriptor called on a non-object: ";Object.getOwnPropertyDescriptor=function(e,t){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError(f+e);if(d)try{return d.call(Object,e,t)}catch(n){}var o;if(!c(e,t))return o;if(o={enumerable:!0,configurable:!0},p){var s=e.__proto__,l=e!==a;l&&(e.__proto__=a);var u=r(e,t),m=i(e,t);if(l&&(e.__proto__=s),u||m)return u&&(o.get=u),m&&(o.set=m),o}return o.value=e[t],o.writable=!0,o}}if(Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(e){return Object.keys(e)}),!Object.create){var m,y=!({__proto__:null}instanceof Object);m=y||"undefined"==typeof document?function(){return{__proto__:null}}:function(){function e(){}var t=document.createElement("iframe"),n=document.body||document.documentElement;t.style.display="none",n.appendChild(t),t.src="javascript:";var o=t.contentWindow.Object.prototype;return n.removeChild(t),t=null,delete o.constructor,delete o.hasOwnProperty,delete o.propertyIsEnumerable,delete o.isPrototypeOf,delete o.toLocaleString,delete o.toString,delete o.valueOf,o.__proto__=null,e.prototype=o,m=function(){return new e},new e},Object.create=function(e,t){function n(){}var o;if(null===e)o=m();else{if("object"!=typeof e&&"function"!=typeof e)throw new TypeError("Object prototype may only be an Object or null");n.prototype=e,o=new n,o.__proto__=e}return void 0!==t&&Object.defineProperties(o,t),o}}if(Object.defineProperty){var h=t({}),v="undefined"==typeof document||t(document.createElement("div"));if(!h||!v)var b=Object.defineProperty,g=Object.defineProperties}if(!Object.defineProperty||b){var k="Property description must be an object: ",T="Object.defineProperty called on non-object: ",w="getters & setters can not be defined on this javascript engine";Object.defineProperty=function(e,t,s){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError(T+e);if("object"!=typeof s&&"function"!=typeof s||null===s)throw new TypeError(k+s);if(b)try{return b.call(Object,e,t,s)}catch(c){}if("value"in s)if(p&&(r(e,t)||i(e,t))){var l=e.__proto__;e.__proto__=a,delete e[t],e[t]=s.value,e.__proto__=l}else e[t]=s.value;else{if(!p)throw new TypeError(w);"get"in s&&n(e,t,s.get),"set"in s&&o(e,t,s.set)}return e}}(!Object.defineProperties||g)&&(Object.defineProperties=function(e,t){if(g)try{return g.call(Object,e,t)}catch(n){}for(var o in t)c(t,o)&&"__proto__"!==o&&Object.defineProperty(e,o,t[o]);return e}),Object.seal||(Object.seal=function(e){if(Object(e)!==e)throw new TypeError("Object.seal can only be called on Objects.");return e}),Object.freeze||(Object.freeze=function(e){if(Object(e)!==e)throw new TypeError("Object.freeze can only be called on Objects.");return e});try{Object.freeze(function(){})}catch(S){Object.freeze=function(e){return function(t){return"function"==typeof t?t:e(t)}}(Object.freeze)}Object.preventExtensions||(Object.preventExtensions=function(e){if(Object(e)!==e)throw new TypeError("Object.preventExtensions can only be called on Objects.");return e}),Object.isSealed||(Object.isSealed=function(e){if(Object(e)!==e)throw new TypeError("Object.isSealed can only be called on Objects.");return!1}),Object.isFrozen||(Object.isFrozen=function(e){if(Object(e)!==e)throw new TypeError("Object.isFrozen can only be called on Objects.");return!1}),Object.isExtensible||(Object.isExtensible=function(e){if(Object(e)!==e)throw new TypeError("Object.isExtensible can only be called on Objects.");for(var t="";c(e,t);)t+="?";e[t]=!0;var n=c(e,t);return delete e[t],n})})},function(e,t,n){"use strict";function o(e){this.needReconnect=e.needReconnect!==!1,"undefined"!=typeof e.reconnectionAttempts&&s.verifyParamType("reconnectionAttempts",e.reconnectionAttempts,"number"),this.reconnectionAttempts=e.reconnectionAttempts||1/0,"undefined"!=typeof e.reconnectionDelay&&(s.verifyParamType("reconnectionDelay",e.reconnectionDelay,"number"),e.reconnectionDelay<h.reconnectionDelay&&(e.reconnectionDelay=h.reconnectionDelay)),this.reconnectionDelay=e.reconnectionDelay||h.reconnectionDelay,"undefined"!=typeof e.reconnectionDelayMax&&(s.verifyParamType("reconnectionDelayMax",e.reconnectionDelayMax,"number"),e.reconnectionDelayMax<h.reconnectionDelayMax&&(e.reconnectionDelayMax=h.reconnectionDelayMax)),this.reconnectionDelayMax=e.reconnectionDelayMax||h.reconnectionDelayMax,this.backoff=new i({min:this.reconnectionDelay,max:this.reconnectionDelayMax}),this.options=s.copy(e),this.reset(),this.lbsRetryCount=0,this.shouldReconnect=!0,this.connectViaLbs()}var r=n(17);window.io=r;var i=n(18),s=n(6),a=n(13);a.id=s.guid();var c=n(8),p=n(10),l=n(16),u=n(5),d=n(19),f=n(15),m=n(20),y=n(7),h=n(21),v=n(12);o.prototype.reset=function(){this.reconnecting=!1,this.stopHeartbeat(),this.heartbeatTimer=null,this.cmdCallbackMap={},this.cmdContentMap={},this.syncTime=0,this.syncTeamMembersTime={}},o.prototype.isConnected=function(){return!!this.socket&&!!this.socket.socket&&this.socket.socket.connected},o.prototype.connectViaLbs=function(){this.reconnecting=!1,h.getSocketServerUrl({appKey:this.options.appKey,account:this.options.account,done:function(e,t){e?this.reconnect():this.doConnect(t)}.bind(this)})},o.prototype.doConnect=function(e){this.isConnected()||(v.log("try connect to "+e),this.socket=r.connect(e,{reconnect:!1,"max reconnection attempts":1/0,"connect timeout":h.socketTimeout,transports:["websocket","xhr-polling"],"force new connection":!0,secure:!0,reconnection:!1,reconnectionAttempts:1/0,timeout:h.socketTimeout,forceNew:!0}),this.socket.on("connect",this.onConnect.bind(this)),this.socket.on("error",this.onError.bind(this)),this.socket.on("message",this.onMessage.bind(this)),this.socket.on("disconnect",this.onDisconnect.bind(this)))},o.prototype.onConnect=function(){v.log("onConnect"),this.reset(),this.backoff.reset(),this.shouldReconnect=!0,this.lbsRetryCount=0,this.login()},o.prototype.onDisconnect=function(){this.afterNetworkError(),this.reconnect()},o.prototype.onError=function(){v.log("onError"),this.afterNetworkError(),this.reconnect()},o.prototype.reconnect=function(){if(this.reconnecting)return this;if(this.shouldReconnect){this.reconnecting=!0;var e=h.getNextSocketServerUrl();e?(v.log("will try next lbs"),this.doConnect(e)):(this.socket=null,this.lbsRetryCount<h.lbsMaxRetryCount?(this.lbsRetryCount++,v.log("will refresh lbs"),this.connectViaLbs()):this.noReconnect())}else this.noReconnect()},o.prototype.noReconnect=function(){this.reset(),this.lbsRetryCount=0,this.reconnecting=!1,v.log("onDisconnect"),this.options.ondisconnect({willReconnect:!1})},o.prototype.login=function(){this.sendCmd("login",{login:{os:a.os.toString(),sdkVersion:h.sdkVersion,protocolVersion:h.protocolVersion,deviceId:a.id,appKey:this.options.appKey,account:this.options.account,browser:a.name+" "+a.version,token:this.options.token}},this.onLogin.bind(this))},o.prototype.onLogin=function(e,t){e?(this.afterLoginError(),this.checkMiscError(e,t)):(this.options.onconnect(t),this.syncData(),this.startHeartbeat())},o.prototype.logout=function(){this.sendCmd("logout",null,this.onLogout.bind(this)),this.afterLoginError(),this.socket.disconnect()},o.prototype.onLogout=function(e,t){},o.prototype.kick=function(e){this.sendCmd("kick",{deviceIds:e.deviceIds},e.callback)},o.prototype.onKicked=function(e){switch(v.log("onKicked"),this.afterLoginError(),"undefined"!=typeof e.from&&(e.from=l.reverseType(e.from)),e.reason){case 1:e.reason="samePlatformKick",e.message="Web SDK不允许一个帐号在多个地方同时登录";break;case 2:e.reason="serverKick",e.message="被服务器踢了";break;case 3:e.reason="otherPlatformKick",e.message="被其它端踢了";break;default:e.reason="unknown",e.message="未知原因"}this.options.onkicked(e)},o.prototype.startHeartbeat=function(){this.stopHeartbeat(),this.heartbeatTimer=window.setInterval(function(){this.sendCmd("heartbeat",null,this.onHeartbeat.bind(this))}.bind(this),18e4);

},o.prototype.onHeartbeat=function(e,t){this.checkMiscError(e,t,"send heartbeat error - 发送心跳包失败")},o.prototype.stopHeartbeat=function(){this.heartbeatTimer&&window.clearInterval(this.heartbeatTimer)},o.prototype.syncData=function(){s.verifyBool(this.options,"syncRoamingMsgs syncTeams syncTeamMembers");var e={};e.offline=0,this.options.syncRoamingMsgs&&(e.roamingMsgs=0),this.options.syncTeams&&(e.teams=0),this.sendCmd("sync",{sync:e},this.onSyncData.bind(this))},o.prototype.onSyncData=function(e,t){this.checkMiscError(e,t,"sync data error - 同步数据失败")},o.prototype.syncTeamMembers=function(e){if(this.syncTeamMembersTime={},e.length){var t;e.forEach(function(e){this.syncTeamMembersTime[e.teamId]=0,t={},t[e.teamId]=0,this.sendCmd("syncTeamMembers",{sync:t},this.onSyncTeamMembers.bind(this))}.bind(this))}},o.prototype.onSyncTeamMembers=function(e,t){this.checkMiscError(e,t,"sync teamMembers error - 同步群成员失败")},o.prototype.checkSyncTeamMembers=function(){var e=Object.keys(this.syncTeamMembersTime).some(function(e){return 0===this.syncTeamMembersTime[e]},this);e||this.options.onsyncteammembersdone()},o.prototype.sendMsg=function(e){var t=e.msg;t.to===this.options.account&&(t.fromDeviceId=a.id);var n;switch(t.getScene()){case"p2p":n="sendMsg";break;case"team":n="sendTeamMsg"}this.sendCmd(n,{msg:t,single:!0},e.callback)},o.prototype.getNosToken=function(e){this.sendCmd("getNosToken",{responseBody:e.responseBody},e.callback)},o.prototype.sendCustomSysMsg=function(e){this.sendCmd("sendCustomSysMsg",{sysMsg:e.sysMsg,single:!0},e.callback)},o.prototype.getHistoryMsgs=function(e){var t;switch(e.scene){case"p2p":t="getHistoryMsgs";break;case"team":t="getTeamHistoryMsgs"}var n={scene:e.scene,to:e.to,beginTime:e.beginTime,endTime:e.endTime,lastMsgId:e.lastMsgId,limit:e.limit,reverse:e.reverse};this.sendCmd(t,n,e.callback)},o.prototype.searchHistoryMsgs=function(e){var t;switch(e.scene){case"p2p":t="searchHistoryMsgs";break;case"team":t="searchTeamHistoryMsgs"}var n=s.filterObj(e,"scene to beginTime endTime keyword limit reverse");this.sendCmd(t,n,e.callback)},o.prototype.createTeam=function(e){var t={team:e.team,accounts:e.accounts,ps:e.ps};this.sendCmd("createTeam",t,e.callback)},o.prototype.addMembers=function(e){var t={teamId:e.teamId,accounts:e.accounts,ps:e.ps};this.sendCmd("addMembers",t,e.callback)},o.prototype.removeMembers=function(e){var t={teamId:e.teamId,accounts:e.accounts};this.sendCmd("removeMembers",t,e.callback)},o.prototype.updateTeam=function(e){this.sendCmd("updateTeam",{team:e.team,single:!0},e.callback)},o.prototype.leaveTeam=function(e){var t={teamId:e.teamId};this.sendCmd("leaveTeam",t,e.callback)},o.prototype.getTeam=function(e){var t={teamId:e.teamId};this.sendCmd("getTeam",t,e.callback)},o.prototype.getTeams=function(e){this.sendCmd("getTeams",{time:0},e.callback)},o.prototype.getTeamMembers=function(e){var t={teamId:e.teamId,time:0};this.sendCmd("getTeamMembers",t,e.callback)},o.prototype.dismissTeam=function(e){var t={teamId:e.teamId};this.sendCmd("dismissTeam",t,e.callback)},o.prototype.applyTeam=function(e){var t={teamId:e.teamId,ps:e.ps};this.sendCmd("applyTeam",t,e.callback)},o.prototype.passApply=function(e){var t={teamId:e.teamId,from:e.from};this.sendCmd("passApply",t,e.callback)},o.prototype.rejectApply=function(e){var t={teamId:e.teamId,from:e.from,ps:e.ps||""};this.sendCmd("rejectApply",t,e.callback)},o.prototype.addManagers=function(e){var t={teamId:e.teamId,accounts:e.accounts};this.sendCmd("addManagers",t,e.callback)},o.prototype.removeManagers=function(e){var t={teamId:e.teamId,accounts:e.accounts};this.sendCmd("removeManagers",t,e.callback)},o.prototype.transferTeam=function(e){var t={teamId:e.teamId,account:e.account,leave:e.leave};this.sendCmd("transferTeam",t,e.callback)},o.prototype.updateInfoInTeam=function(e){this.sendCmd("updateInfoInTeam",{teamMember:e.teamMember,single:!0},e.callback)},o.prototype.updateNickInTeam=function(e){this.sendCmd("updateNickInTeam",{teamMember:new m.TeamMember(e),single:!0},e.callback)},o.prototype.acceptInvite=function(e){var t={teamId:e.teamId,from:e.from};this.sendCmd("acceptInvite",t,e.callback)},o.prototype.rejectInvite=function(e){var t={teamId:e.teamId,from:e.from,ps:e.ps||""};this.sendCmd("rejectInvite",t,e.callback)},o.prototype.markMsgsRead=function(e){var t=[],n=[];e.forEach(function(e){switch(e.scene){case"p2p":t.push(e);break;case"team":n.push(e)}}),t.length&&this.doMarkMsgsRead(p.idMap.talk.id,p.idMap.talk.msgNotify,t),n.length&&this.doMarkMsgsRead(p.idMap.team.id,p.idMap.team.teamMsgNotify,n)},o.prototype.markSysMsgsRead=function(e){this.doMarkMsgsRead(p.idMap.talk.id,p.idMap.talk.sysMsgNotify,e)},o.prototype.doMarkMsgsRead=function(e,t,n){this.sendCmd("batchMarkRead",{sid:e,cid:t,ids:n.map(function(e){return e.idServer})},null,this.onMarkMsgsRead.bind(this))},o.prototype.onMarkMsgsRead=function(e,t){this.checkMiscError(e,t,"标记消息已读失败")},o.prototype.onMessage=function(e){var t=c.parsePacket(e);switch(t.obj=this.getPacketObj(t),v.log("socket content	"+t.cmd,t),t.service){case"link":this.processLink(t);break;case"auth":this.processAuth(t);break;case"notify":this.processNotify(t);break;case"sync":this.processSync(t);break;case"misc":this.processMisc(t);break;case"talk":this.processTalk(t);break;case"team":this.processTeam(t);break;default:return}this.callPacketAckCallback(t)},o.prototype.getPacketObj=function(e){if(e&&e.raw){var t=e.raw.ser;if(t)return this.getObjWithSer(t)}return null},o.prototype.callPacketAckCallback=function(e){if(e&&e.raw){var t=e.raw.ser;if(t){var n=this.getCallbackWithSer(t);n&&n(e.error,e.obj)}}},o.prototype.processLink=function(e){switch(e.cmd){case"heartbeatAck":}},o.prototype.processAuth=function(e){switch(e.cmd){case"loginAck":e.error||(e.obj=e.content.loginRes,this.onLoginPortsChange(e.content.loginPorts,2));break;case"kickedNotify":return void this.onKicked(e.content);case"multiPortLoginNotify":this.onLoginPortsChange(e.content.loginPorts,e.content.state);break;case"kickAck":e.error||(e.obj.deviceIds=e.content.deviceIds)}},o.prototype.onLoginPortsChange=function(e,t){if(e&&e.length){var n=!0;switch(t){case 2:n=!0;break;case 3:n=!1}e.forEach(function(e){e.type=l.reverseType(e.type),e.time=+e.time,e.online=n}),this.options.onloginportschange(e)}},o.prototype.processNotify=function(e){var t;switch(e.cmd){case"syncOfflineMsgsNotify":t=e.content.msgs.map(function(e){return u.reverse(e)}),this.markMsgsRead(t),this.options.onofflinemsgs(t);break;case"batchMarkReadAck":break;case"syncOfflineSysMsgsNotify":t=e.content.sysMsgs.map(function(e){return d.reverse(e)}),this.markSysMsgsRead(t),this.options.onofflinesysmsgs(t);break;case"syncRoamingMsgsNotify":t=e.content.msgs.map(function(e){return u.reverse(e)}),this.options.onroamingmsgs(t)}},o.prototype.processSync=function(e){switch(e.cmd){case"syncAck":this.syncTime=e.content.syncTime,this.options.onsyncdone();break;case"syncTeamMembersAck":}},o.prototype.processMisc=function(e){switch(e.cmd){case"getNosTokenAck":e.error||(e.obj=e.content.nosToken)}},o.prototype.processTalk=function(e){var t=e.obj;switch(e.cmd){case"sendMsgAck":e.error||(t.idServer=e.content.msg.idServer,t.time=e.content.msg.time),t.from=this.options.account,e.obj=u.reverse(t);break;case"msgNotify":t=u.reverse(e.content.msg),this.markMsgsRead([t]),this.options.onmsg(t);break;case"sysMsgNotify":t=d.reverse(e.content.sysMsg),this.markSysMsgsRead([t]),-1===t.type.indexOf("custom")?this.options.onsysmsg(t):(t.scene=t.type.slice(6).toLowerCase(),delete t.type,this.options.oncustomsysmsg(t));break;case"sendCustomSysMsgAck":e.obj=d.reverse(t),e.obj.from=this.options.account,e.obj.scene=e.obj.type.slice(6).toLowerCase(),delete e.obj.type;break;case"getHistoryMsgsAck":case"searchHistoryMsgsAck":e.error||(e.obj.msgs=e.content.msgs.map(function(e){return u.reverse(e)}));break;case"syncSendMsgNotify":t=u.reverse(e.content.msg),this.markMsgsRead([t]),this.options.onmsg(t)}},o.prototype.processTeam=function(e){var t,n,o=e.obj;switch(e.cmd){case"createTeamAck":e.error||(o.team=e.content.team),e.obj.team=f.reverse(o.team);break;case"sendTeamMsgAck":e.error||(o.idServer=e.content.msg.idServer,o.time=e.content.msg.time),o.from=this.options.account,e.obj=u.reverse(o);break;case"teamMsgNotify":o=u.reverse(e.content.msg),this.markMsgsRead([o]),this.options.onmsg(o);break;case"teamMsgsNotify":t=e.content.msgs.map(function(e){return u.reverse(e)},this),this.markMsgsRead(t),t.forEach(function(e){this.options.onmsg(e)},this);break;case"addMembersAck":case"removeMembersAck":case"leaveTeamAck":case"dismissTeamAck":case"passApplyAck":case"rejectApplyAck":case"addManagersAck":case"removeManagersAck":case"transferTeamAck":case"rejectInviteAck":break;case"updateInfoInTeamAck":case"updateNickInTeamAck":e.obj=m.reverse(e.obj);break;case"updateTeamAck":e.obj=f.reverse(e.obj);break;case"getTeamAck":case"applyTeamAck":case"acceptInviteAck":e.error||(e.obj=f.reverse(e.content.team));break;case"getTeamsAck":e.error||(e.obj=e.content.teams.map(function(e){return f.reverse(e)}));break;case"getTeamMembersAck":e.error||(e.obj={teamId:e.content.teamId,members:e.content.members.map(function(e){return m.reverse(e)})});break;case"syncTeamsNotify":o=e.content.teams.map(function(e){return f.reverse(e)}),this.options.onteams(o),this.options.syncTeamMembers&&this.syncTeamMembers(o);break;case"syncTeamMembersNotify":n=e.content.members.map(function(e){return m.reverse(e)}),this.options.onteammembers({teamId:e.content.teamId,members:n}),this.syncTeamMembersTime[e.content.teamId]=e.content.syncTime,this.checkSyncTeamMembers();break;case"getTeamHistoryMsgsAck":case"searchTeamHistoryMsgsAck":e.error||(e.obj.msgs=e.content.msgs.map(function(e){return u.reverse(e)}));break;case"syncCreateTeamNotify":o=f.reverse(e.content.team),this.options.oncreateteam(o);break;case"syncSendTeamMsgNotify":o=u.reverse(e.content.msg),this.options.onmsg(o);break;case"syncUpdateTeamMemberNotify":o=e.content.teamMember,this.options.onupdateteammember(o)}},o.prototype.sortMsgs=function(e){e.sort(function(e,t){return e.time-t.time})},o.prototype.sortTeams=function(e){e.sort(function(e,t){return e.type!==t.type?"normal"===e.type?-1:1:e.teamId-t.teamId})},o.prototype.sendCmd=function(e,t,n){v.log("socket command	"+e,t?t:""),e=c.createCmd(e,t);var o=e.SER;if(t&&(this.cmdContentMap[o]=t,t.single)){delete t.single;var r=Object.keys(t);1===r.length&&(this.cmdContentMap[o]=t[r[0]])}return n&&(this.cmdCallbackMap[o]=n),this.isConnected()?this.doSendCmd(e):this.markCallbackInvalid(o,y.newConnectionError()),o},o.prototype.doSendCmd=function(e){this.socket.send(JSON.stringify(e))},o.prototype.afterNetworkError=function(){this.markAllCallbackInvalid(y.newNetworkError()),this.reset()},o.prototype.afterLoginError=function(){this.markAllCallbackInvalid(y.newConnectionError()),this.reset(),this.shouldReconnect=!1},o.prototype.checkMiscError=function(e,t,n){e&&(e.appendMessage(n),this.reset(),this.shouldReconnect=!1,t=t||{},t.willReconnect=!1,this.options.onerror(e,t))},o.prototype.markAllCallbackInvalid=function(e){Object.keys(this.cmdCallbackMap).forEach(function(t){this.markCallbackInvalid(t,e)},this)},o.prototype.markCallbackInvalid=function(e,t){var n=this.getCallbackWithSer(e);if(this.getObjWithSer(e),!n)throw t;var o=n.options;setTimeout(function(){n(t||y.newUnknownError(),o)}.bind(this),100)},o.prototype.getCallbackWithSer=function(e){var t=this.cmdCallbackMap[e];return delete this.cmdCallbackMap[e],t},o.prototype.getObjWithSer=function(e){var t=this.cmdContentMap[e];return delete this.cmdContentMap[e],t},e.exports=o},function(e,t,n){"use strict";function o(e){d.verifyOptions(e,"scene to"),d.verifyParamValid("scene",e.scene,T()),this.scene=h[e.scene],this.to=e.to,this.time=+new Date,this.type=b[e.type],this.resend=e.resend?1:0,e.resend?(d.verifyOptions(e,"idClient"),this.idClient=e.idClient):this.idClient=d.guid()}function r(e){d.verifyOptions(e,"text"),e.type="text",o.call(this,e),this.body=e.text}function i(e){}function s(e){}function a(e){}function c(e){switch("undefined"!=typeof e.type?d.verifyFileType(e.type):e.type="file",d.verifyOptions(e,"file"),d.verifyOptions(e.file,"url ext size md5",!0,"file."),e.type){case"image":i.verifyFile(e.file);break;case"audio":s.verifyFile(e.file);break;case"video":a.verifyFile(e.file)}o.call(this,e),this.attach=JSON.stringify(e.file)}function p(e){d.verifyOptions(e,"geo"),d.verifyOptions(e.geo,"lng lat title",!0,"geo."),d.verifyParamType("geo.lng",e.geo.lng,"number"),d.verifyParamType("geo.lat",e.geo.lat,"number"),d.verifyParamType("geo.title",e.geo.title,"string"),o.call(this,e),this.attach=JSON.stringify(e.geo)}function l(e){d.verifyOptions(e,"content"),o.call(this,e),this.attach=e.content}function u(e){}var d=n(6),f=n(8),m=n(15),y=n(16),h={p2p:0,team:1},v={0:"p2p",1:"team"},b={text:0,image:1,audio:2,video:3,geo:4,notification:5,file:6,custom:100},g={0:"text",1:"image",2:"audio",3:"video",4:"geo",5:"notification",6:"file",100:"custom"},k={0:"addMembers",1:"removeMembers",2:"leaveTeam",3:"updateTeam",4:"dismissTeam",5:"passApply",6:"transferTeam",7:"addManagers",8:"removeManagers",9:"acceptInvite"};o.prototype.getScene=function(){return v[this.scene]},o.reverse=function(e){var t=v[e.scene],n=g[e.type],o={scene:t||e.scene,to:e.to,time:+e.time,type:n||e.type,resend:1===+e.resend};return"team"===t&&(o.to=+o.to),"undefined"!=typeof e.from&&(o.from=e.from),"undefined"!=typeof e.fromNick&&(o.fromNick=e.fromNick),"undefined"!=typeof e.fromClientType&&(o.fromClientType=y.reverseType(e.fromClientType)),"undefined"!=typeof e.fromDeviceId&&(o.fromDeviceId=e.fromDeviceId),"undefined"!=typeof e.idClient&&(o.idClient=e.idClient),"undefined"!=typeof e.idServer&&(o.idServer=+e.idServer),o},r.prototype=Object.create(o.prototype),r.reverse=function(e){var t=o.reverse(e);return t.text=e.body,t},i.verifyFile=function(e){d.verifyOptions(e,"w h",!0,"file.")},s.verifyFile=function(e){d.verifyOptions(e,"dur",!0,"file.")},a.verifyFile=function(e){d.verifyOptions(e,"dur w h",!0,"file.")},c.prototype=Object.create(o.prototype),c.reverse=function(e){var t=o.reverse(e);return t.file="undefined"!=typeof e.attach?JSON.parse(e.attach):{},t},p.prototype=Object.create(o.prototype),p.reverse=function(e){var t=o.reverse(e);return t.geo="undefined"!=typeof e.attach?JSON.parse(e.attach):{},t},l.prototype=Object.create(o.prototype),l.reverse=function(e){var t=o.reverse(e);return"undefined"!=typeof e.attach&&(t.content=e.attach),t},u.reverse=function(e){var t=o.reverse(e);if("undefined"!=typeof e.attach){var n=JSON.parse(e.attach);if(t.attach={type:k[n.id]},"undefined"!=typeof n.data){var r=n.data;"undefined"!=typeof r.tinfo&&(t.attach.team=m.reverse(f.unserialize(r.tinfo,"team"))),"undefined"!=typeof r.ids&&(t.attach.accounts=r.ids),"undefined"!=typeof r.id&&(t.attach.account=r.id)}}return t};var T=function(){return Object.keys(h)},w=function(e){var t,n=g[e.type]||e.type;switch(n){case"text":t=r.reverse(e);break;case"image":case"audio":case"video":case"file":t=c.reverse(e);break;case"geo":t=p.reverse(e);break;case"notification":t=u.reverse(e);break;case"custom":t=l.reverse(e);break;default:t=o.reverse(e)}return t};e.exports={Message:o,TextMessage:r,FileMessage:c,GeoMessage:p,CustomMessage:l,validScenes:T,reverse:w}},function(e,t,n){"use strict";var o=n(7),r={},i=/\s/;r.guid=function(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+e()+e()+e()+e()+e()+e()+e()},r.copy=function(e,t){return t=t||{},Object.keys(e).forEach(function(n){t[n]=e[n]}),t},r.merge=function(e){e=e||{};for(var t=1,n=arguments.length;n>t;t++)r.copy(arguments[t],e);return e},r.filterObj=function(e,t){var n={};return t=t.split(i),t.forEach(function(t){e.hasOwnProperty(t)&&(n[t]=e[t])}),n},r.extend=function(e,t,n){for(var o in t)("undefined"==typeof e[o]||n===!0)&&(e[o]=t[o])},r.emptyFunc=function(){},r.splice=function(e,t,n){return[].splice.call(e,t,n)},r.onError=function(e){throw new o(e)},r.typeOf=function(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()},r.isString=function(e){return"string"===r.typeOf(e)},r.isBool=function(e){return"boolean"===r.typeOf(e)},r.isArray=function(e){return"array"===r.typeOf(e)},r.isFunction=function(e){return"function"===r.typeOf(e)},r.isObject=function(e){return"object"===r.typeOf(e)},r.verifyParamPresent=function(e,t,n){n=n||"";var o=!1;switch(r.typeOf(t)){case"undefined":case"null":o=!0;break;case"string":""===t&&(o=!0);break;case"array":t.length||(o=!0)}o&&r.onParamAbsent(n+e)},r.onParamAbsent=function(e){r.onParamError('缺少参数"'+e+'"')},r.verifyParamAbsent=function(e,t,n){n=n||"",void 0!==t&&r.onParamPresent(n+e)},r.onParamPresent=function(e){r.onParamError('非法参数"'+e+'"')},r.verifyParamType=function(e,t,n){var o=r.typeOf(t).toLowerCase();r.isArray(n)||(n=[n]),n=n.map(function(e){return e.toLowerCase()});var i=!0;switch(-1===n.indexOf(o)&&(i=!1),o){case"number":isNaN(t)&&(i=!1)}i||r.onParamInvalidType(e,n)},r.onParamInvalidType=function(e,t){r.isArray(t)?(t=t.map(function(e){return'"'+e+'"'}),t=t.join(", ")):t='"'+t+'"',r.onParamError('参数"'+e+'"类型错误，合法的类型包括：['+t+"]")},r.verifyParamValid=function(e,t,n){r.isArray(n)||(n=[n]),-1===n.indexOf(t)&&r.onParamInvalidValue(e,n)},r.onParamInvalidValue=function(e,t){r.isArray(t)||(t=[t]),t=t.map(function(e){return'"'+e+'"'}),r.isArray(t)&&(t=t.join(", ")),r.onParamError('参数"'+e+'"值错误，合法的值包括：['+t+"]")},r.verifyParamMax=function(e,t,n){t>n&&r.onParamError("参数"+e+"的值不能超过"+n)},r.onParamError=function(e){r.onError(e)},r.verifyOptions=function(e,t,n,o){if(r.verifyParamPresent("options",e),t&&(r.isString(t)&&(t=t.split(i)),r.isArray(t))){n=void 0===n?!0:!!n;var s=n?r.verifyParamPresent:r.verifyParamAbsent;t.forEach(function(t){s.call(r,t,e[t],o)})}},r.verifyBool=function(e,t,n){i.test(t)&&(t=t.split(i)),r.isArray(t)?t.forEach(function(t){r.verifyBool(e,t)}):void 0===e[t]?e[t]=n||!0:r.isBool(e[t])||r.onParamInvalidType(t,"boolean")},r.verifyFileInput=function(e){return r.verifyParamPresent("fileInput",e),r.isString(e)&&(e=window.document.getElementById(e),e||r.onParamError("找不到要上传的文件对应的input，请检查fileInput id")),("input"!==e.tagName.toLowerCase()||"file"!==e.type.toLowerCase())&&r.onParamError("请提供正确的fileInput"),e},r.verifyFileType=function(e){r.verifyParamValid("type",e,r.validFileTypes)},r.verifyCallback=function(e,t){i.test(t)&&(t=t.split(i)),r.isArray(t)?t.forEach(function(t){r.verifyCallback(e,t)}):e[t]?r.isFunction(e[t])||r.onParamInvalidType(t,"function"):e[t]=r.emptyFunc},r.verifyFileUploadCallback=function(e){r.verifyCallback(e,"uploadprogress uploaddone uploaderror uploadcancel")};r.validFileTypes=["image","audio","video","file"],r.filterFiles=function(e,t){t=t.toLowerCase();var n,o,r,i="file"===t,s=[];return[].forEach.call(e,function(e){i?s.push(e):(n=e.type.split("/"),n[0]&&n[1]&&(o=n[0].toLowerCase(),r=n[1].toLowerCase(),o===t&&s.push(e)))}),s},r.getFileName=function(){var e="undefined"!=typeof window.FormData;return function(t){return t=r.verifyFileInput(t),e?t.files[0].name:t.value.slice(t.value.lastIndexOf("\\")+1)}}(),r.sizeText=function(){var e=["B","KB","MB","GB","TB","PB","EB","ZB","BB"];return function(t){var n,o=0;do{t=Math.floor(100*t)/100;var r=e[o];n=t+r,t/=1024,o++}while(t>1);return n}}(),e.exports=r},function(e,t){"use strict";function n(e,t){this.message=e,this.code=t}n.prototype=Object.create(Error.prototype),n.prototype.name="NIMError",n.prototype.appendMessage=function(e){this.message?e&&(this.message+="("+e+")"):this.message=e};var o={201:"客户端版本过低",302:"帐号或者密码错误，请检查appKey和token是否有效，account和token是否匹配",403:"操作被禁止",404:"目标(用户或群)不存在",406:"数据自上次查询以来未发生变化",414:"非法参数",422:"帐号被禁用",500:"未知错误",501:"数据库操作失败",503:"服务器繁忙",509:"已失效",801:"已达人数上限",802:"没有权限",803:"群不存在",804:"用户不在群里面",805:"群类型不对",806:"创建群数量限制",807:"群成员状态不对",809:"已经在群里"};[200,808,810].forEach(function(e){o[e]=null}),n.genError=function(e){var t=o[e];return void 0===t&&(t="操作失败"),null===t?null:new n(t,e)},n.newServerError=function(e){return new n(e||"无法连接到socket服务器","Server_Not_Available")},n.newParamError=function(e){return new n(e||"参数错误","Param_Error")},n.newNoFileError=function(e){return new n(e||"请选择文件","No_File_Selected")},n.newWrongFileTypeError=function(e){return new n(e||"文件类型错误","Wrong_File_Type")},n.newFileTooLargeError=function(e){return new n(e||"文件过大","File_Too_Large")},n.newTimeoutError=function(){return new n("Error_Timeout","Error_Timeout")},n.newNetworkError=function(){return new n("Error_Internet_Disconnected","Error_Internet_Disconnected")},n.newConnectionError=function(){return new n("Error_Connection_is_not_Established, please try later","Error_Connection_is_not_Established")},n.newUnknownError=function(){return new n("Error_Unknown","Error_Unknown")},e.exports=n},function(e,t,n){"use strict";function o(e,t){var n=s[t],o={};for(var r in n)e.hasOwnProperty(r)&&(o[n[r]]=e[r]);return o}var r=n(10),i=n(6),s=n(11),a=n(9),c=n(7),p=n(12),l=1,u={};u.createCmd=function(e,t){var n=r.cmdConfig[e];return e={SID:n.sid,CID:n.cid,SER:l++},n.params&&(e.Q=[],n.params.forEach(function(n,r){var i,s=n.type,a=n.name;switch(s){case"Property":i=o(t[a],a);break;case"bool":i=t[a]?"true":"false";break;default:i=t[a]}e.Q.push({t:s,v:i})})),e},u.parsePacket=function(e){var t=JSON.parse(e),n={raw:t,error:c.genError(t.code)},o=r.packetConfig[t.sid+"_"+t.cid];if(!o)return p.log("no config for sid: "+t.sid+" cid: "+t.cid),n;var s=t.r,a="notify"===o.service&&!o.cmd;if(a){var l=t.r[1].headerPacket;if(o=r.packetConfig[l.sid+"_"+l.cid],s=t.r[1].body,!o)return p.log("no config for sid: "+l.sid+" cid: "+l.cid),n}return n.service=o.service,n.cmd=o.cmd,!n.error&&o.response&&(n.content={},o.response.forEach(function(e,o){var r=s[o];if(r){var c=e.type,p=e.name,l=e.entity||p;switch(c){case"Property":n.content[p]=u.unserialize(r,l);break;case"PropertyArray":n.content[p]=[],r.forEach(function(e,t){n.content[p].push(u.unserialize(e,l))});break;case"StrArray":n.content[p]=r;break;case"Number":n.content[p]=+r}if(a&&"msg"===p||"sysMsg"===p){var d=n.content[p];i.isObject(d)&&(d.idServer=t.r[0])}}})),n},u.unserialize=function(e,t){var n=a[t],o={};for(var r in n)e.hasOwnProperty(r)&&(o[n[r]]=e[r]);return o},e.exports=u},function(e,t){e.exports={login:{4:"os",6:"sdkVersion",9:"protocolVersion",13:"deviceId",18:"appKey",19:"account",24:"browser",1000:"token"},loginRes:{17:"lastLoginDeviceId",102:"connectionId",103:"ip",104:"port",106:"country"},loginPort:{3:"type",4:"os",5:"mac",13:"deviceId",19:"account",102:"connectionId",103:"ip",109:"time"},sync:{1:"myInfo",2:"offline",3:"teams",7:"roamingMsgs"},team:{1:"teamId",2:"appId",3:"name",4:"type",5:"owner",6:"level",7:"selfCustom",8:"valid",9:"memberNum",10:"memberUpdateTime",11:"createTime",12:"updateTime",13:"validToCurrentUser",14:"intro",15:"announcement",16:"joinMode",17:"bits",18:"custom",19:"serverCustom"},teamMember:{1:"teamId",2:"uid",3:"account",4:"type",5:"nickInTeam",6:"invitorUid",7:"bits",8:"active",10:"joinTime",11:"updateTime"},msg:{0:"scene",1:"to",2:"from",4:"fromClientType",5:"fromDeviceId",6:"fromNick",7:"time",8:"type",9:"body",10:"attach",11:"idClient",12:"idServer",13:"resend"},sysMsg:{0:"time",1:"type",2:"to",3:"from",4:"ps",5:"attach",6:"idServer",7:"sendToOnlineUsersOnly",8:"apnsText"},nosToken:{1:"objectName",2:"token",3:"bucket",4:"expireTime"}}},function(e,t){"use strict";var n={link:{id:1,heartbeat:2},auth:{id:2,login:3,kickedNotify:5,logout:6,multiPortLoginNotify:7,kick:8},notify:{id:4,markRead:3,syncOfflineMsgsNotify:4,batchMarkRead:5,syncOfflineSysMsgsNotify:6,syncRoamingMsgsNotify:9},sync:{id:5,sync:1,syncTeamMembers:2},misc:{id:6,getNosToken:2},talk:{id:7,sendMsg:1,msgNotify:2,sysMsgNotify:3,getHistoryMsgs:6,sendCustomSysMsg:7,searchHistoryMsgs:8,syncSendMsgNotify:101},team:{id:8,createTeam:1,sendTeamMsg:2,teamMsgNotify:3,teamMsgsNotify:4,addMembers:5,removeMembers:6,updateInfo:7,leaveTeam:8,getTeam:9,getTeams:10,getTeamMembers:11,dismissTeam:12,applyTeam:13,passApply:14,rejectApply:15,addManagers:16,removeManagers:17,transferTeam:18,updateInfoInTeam:19,updateNickInTeam:20,acceptInvite:21,rejectInvite:22,getTeamHistoryMsgs:23,searchTeamHistoryMsgs:24,syncTeamsNotify:109,syncTeamMembersNotify:111,syncCreateTeamNotify:101,syncSendTeamMsgNotify:102,syncUpdateTeamMemberNotify:119}},o={heartbeat:{sid:n.link.id,cid:n.link.heartbeat},login:{sid:n.auth.id,cid:n.auth.login,params:[{type:"Property",name:"login"}]},logout:{sid:n.auth.id,cid:n.auth.logout},kick:{sid:n.auth.id,cid:n.auth.kick,params:[{type:"StrArray",name:"deviceIds"}]},markRead:{sid:n.notify.id,cid:n.notify.markRead,params:[{type:"long",name:"id"},{type:"ph",name:"ph"}]},batchMarkRead:{sid:n.notify.id,cid:n.notify.batchMarkRead,params:[{type:"byte",name:"sid"},{type:"byte",name:"cid"},{type:"LongArray",name:"ids"}]},sync:{sid:n.sync.id,cid:n.sync.sync,params:[{type:"Property",name:"sync"}]},syncTeamMembers:{sid:n.sync.id,cid:n.sync.syncTeamMembers,params:[{type:"LongLongMap",name:"sync"}]},getNosToken:{sid:n.misc.id,cid:n.misc.getNosToken,params:[{type:"String",name:"responseBody"}]},sendMsg:{sid:n.talk.id,cid:n.talk.sendMsg,params:[{type:"Property",name:"msg"}]},getHistoryMsgs:{sid:n.talk.id,cid:n.talk.getHistoryMsgs,params:[{type:"String",name:"to"},{type:"long",name:"beginTime"},{type:"long",name:"endTime"},{type:"long",name:"lastMsgId"},{type:"int",name:"limit"},{type:"bool",name:"reverse"}]},sendCustomSysMsg:{sid:n.talk.id,cid:n.talk.sendCustomSysMsg,params:[{type:"Property",name:"sysMsg"}]},searchHistoryMsgs:{sid:n.talk.id,cid:n.talk.searchHistoryMsgs,params:[{type:"String",name:"to"},{type:"long",name:"beginTime"},{type:"long",name:"endTime"},{type:"String",name:"keyword"},{type:"int",name:"limit"},{type:"bool",name:"reverse"}]},createTeam:{sid:n.team.id,cid:n.team.createTeam,params:[{type:"Property",name:"team"},{type:"StrArray",name:"accounts"},{type:"String",name:"ps"}]},sendTeamMsg:{sid:n.team.id,cid:n.team.sendTeamMsg,params:[{type:"Property",name:"msg"}]},addMembers:{sid:n.team.id,cid:n.team.addMembers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"},{type:"String",name:"ps"}]},removeMembers:{sid:n.team.id,cid:n.team.removeMembers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"}]},updateTeam:{sid:n.team.id,cid:n.team.updateInfo,params:[{type:"Property",name:"team"}]},leaveTeam:{sid:n.team.id,cid:n.team.leaveTeam,params:[{type:"long",name:"teamId"}]},getTeam:{sid:n.team.id,cid:n.team.getTeam,params:[{type:"long",name:"teamId"}]},getTeams:{sid:n.team.id,cid:n.team.getTeams,params:[{type:"long",name:"time"}]},getTeamMembers:{sid:n.team.id,cid:n.team.getTeamMembers,params:[{type:"long",name:"teamId"},{type:"long",name:"time"}]},dismissTeam:{sid:n.team.id,cid:n.team.dismissTeam,params:[{type:"long",name:"teamId"}]},applyTeam:{sid:n.team.id,cid:n.team.applyTeam,params:[{type:"long",name:"teamId"},{type:"String",name:"ps"}]},passApply:{sid:n.team.id,cid:n.team.passApply,params:[{type:"long",name:"teamId"},{type:"String",name:"from"}]},rejectApply:{sid:n.team.id,cid:n.team.rejectApply,params:[{type:"long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},addManagers:{sid:n.team.id,cid:n.team.addManagers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"}]},removeManagers:{sid:n.team.id,cid:n.team.removeManagers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"}]},transferTeam:{sid:n.team.id,cid:n.team.transferTeam,params:[{type:"long",name:"teamId"},{type:"String",name:"account"},{type:"bool",name:"leave"}]},updateInfoInTeam:{sid:n.team.id,cid:n.team.updateInfoInTeam,params:[{type:"Property",name:"teamMember"}]},updateNickInTeam:{sid:n.team.id,cid:n.team.updateNickInTeam,params:[{type:"Property",name:"teamMember"}]},acceptInvite:{sid:n.team.id,cid:n.team.acceptInvite,params:[{type:"long",name:"teamId"},{type:"String",name:"from"}]},rejectInvite:{sid:n.team.id,cid:n.team.rejectInvite,params:[{type:"long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},getTeamHistoryMsgs:{sid:n.team.id,cid:n.team.getTeamHistoryMsgs,params:[{type:"long",name:"to"},{type:"long",name:"beginTime"},{type:"long",name:"endTime"},{type:"long",name:"lastMsgId"},{type:"int",name:"limit"},{type:"bool",name:"reverse"}]},searchTeamHistoryMsgs:{sid:n.team.id,cid:n.team.searchTeamHistoryMsgs,params:[{type:"long",name:"to"},{type:"long",name:"beginTime"},{type:"long",name:"endTime"},{type:"String",name:"keyword"},{type:"int",name:"limit"},{type:"bool",name:"reverse"}]}},r={"1_2":{service:"link",cmd:"heartbeatAck"},"2_3":{service:"auth",cmd:"loginAck",response:[{type:"Property",name:"loginRes"},{type:"PropertyArray",name:"loginPorts",entity:"loginPort"}]},"2_5":{service:"auth",cmd:"kickedNotify",response:[{type:"Number",name:"from"},{type:"Number",name:"reason"}]},"2_6":{service:"auth",cmd:"logoutAck"},"2_7":{service:"auth",cmd:"multiPortLoginNotify",response:[{type:"Number",name:"state"},{type:"PropertyArray",name:"loginPorts",entity:"loginPort"}]},"2_8":{service:"auth",cmd:"kickAck",response:[{type:"StrArray",name:"deviceIds"}]},"4_1":{service:"notify"},"4_2":{service:"notify"},"4_3":{service:"notify",cmd:"markReadAck"},"4_4":{service:"notify",cmd:"syncOfflineMsgsNotify",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"4_5":{service:"notify",cmd:"batchMarkReadAck"},"4_6":{service:"notify",cmd:"syncOfflineSysMsgsNotify",response:[{type:"PropertyArray",name:"sysMsgs",entity:"sysMsg"}]},"4_9":{service:"notify",cmd:"syncRoamingMsgsNotify",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"5_1":{service:"sync",cmd:"syncAck",response:[{type:"Number",name:"syncTime"}]},"5_2":{service:"sync",cmd:"syncTeamMembersAck",response:[{type:"Number",name:"syncTime"}]},"6_2":{service:"misc",cmd:"getNosTokenAck",response:[{type:"Property",name:"nosToken"}]},"7_1":{service:"talk",cmd:"sendMsgAck",response:[{type:"Property",name:"msg"}]},"7_2":{service:"talk",cmd:"msgNotify",response:[{type:"Property",name:"msg"}]},"7_3":{service:"talk",cmd:"sysMsgNotify",response:[{type:"Property",name:"sysMsg"}]},"7_6":{service:"talk",cmd:"getHistoryMsgsAck",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"7_7":{service:"talk",cmd:"sendCustomSysMsgAck"},"7_8":{service:"talk",cmd:"searchHistoryMsgsAck",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"7_101":{service:"talk",cmd:"syncSendMsgNotify",response:[{type:"Property",name:"msg"}]},"8_1":{service:"team",cmd:"createTeamAck",response:[{type:"Property",name:"team"}]},"8_2":{service:"team",cmd:"sendTeamMsgAck",response:[{type:"Property",name:"msg"}]},"8_3":{service:"team",cmd:"teamMsgNotify",response:[{type:"Property",name:"msg"}]},"8_4":{service:"team",cmd:"teamMsgsNotify",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"8_5":{service:"team",cmd:"addMembersAck"},"8_6":{service:"team",cmd:"removeMembersAck"},"8_7":{service:"team",cmd:"updateTeamAck",response:[{type:"Number",name:"id"},{type:"Number",name:"time"}]},"8_8":{service:"team",cmd:"leaveTeamAck"},"8_9":{service:"team",cmd:"getTeamAck",response:[{type:"Property",name:"team"}]},"8_10":{service:"team",cmd:"getTeamsAck",response:[{type:"PropertyArray",name:"teams",entity:"team"},{type:"Number",name:"time"}]},"8_11":{service:"team",cmd:"getTeamMembersAck",response:[{type:"Number",name:"teamId"},{type:"PropertyArray",name:"members",entity:"teamMember"},{type:"Number",name:"time"}]},"8_12":{service:"team",cmd:"dismissTeamAck"},"8_13":{service:"team",cmd:"applyTeamAck",response:[{type:"Property",name:"team"}]},"8_14":{service:"team",cmd:"passApplyAck"},"8_15":{service:"team",cmd:"rejectApplyAck"},"8_16":{service:"team",cmd:"addManagersAck"},"8_17":{service:"team",cmd:"removeManagersAck"},"8_18":{service:"team",cmd:"transferTeamAck"},"8_19":{service:"team",cmd:"updateInfoInTeamAck"},"8_20":{service:"team",cmd:"updateNickInTeamAck"},"8_21":{service:"team",cmd:"acceptInviteAck",response:[{type:"Property",name:"team"}]},"8_22":{service:"team",cmd:"rejectInviteAck"},"8_23":{service:"team",cmd:"getTeamHistoryMsgsAck",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"8_24":{
service:"team",cmd:"searchTeamHistoryMsgsAck",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"8_109":{service:"team",cmd:"syncTeamsNotify",response:[{type:"Number",name:"syncTime"},{type:"PropertyArray",name:"teams",entity:"team"}]},"8_111":{service:"team",cmd:"syncTeamMembersNotify",response:[{type:"Number",name:"teamId"},{type:"PropertyArray",name:"members",entity:"teamMember"},{type:"Number",name:"syncTime"}]},"8_101":{service:"team",cmd:"syncCreateTeamNotify",response:[{type:"Property",name:"team"}]},"8_102":{service:"team",cmd:"syncSendTeamMsgNotify",response:[{type:"Property",name:"msg"}]},"8_119":{service:"team",cmd:"syncUpdateTeamMemberNotify",response:[{type:"Property",name:"teamMember"}]}};e.exports={idMap:n,cmdConfig:o,packetConfig:r}},function(e,t){e.exports={login:{os:4,sdkVersion:6,protocolVersion:9,deviceId:13,appKey:18,account:19,browser:24,token:1e3},loginRes:{lastLoginDeviceId:17,connectionId:102,ip:103,port:104,country:106},loginPort:{type:3,os:4,mac:5,deviceId:13,account:19,connectionId:102,ip:103,time:109},sync:{myInfo:1,offline:2,teams:3,roamingMsgs:7},team:{teamId:1,appId:2,name:3,type:4,owner:5,level:6,selfCustom:7,valid:8,memberNum:9,memberUpdateTime:10,createTime:11,updateTime:12,validToCurrentUser:13,intro:14,announcement:15,joinMode:16,bits:17,custom:18,serverCustom:19},teamMember:{teamId:1,uid:2,account:3,type:4,nickInTeam:5,invitorUid:6,bits:7,active:8,joinTime:10,updateTime:11},msg:{scene:0,to:1,from:2,fromClientType:4,fromDeviceId:5,fromNick:6,time:7,type:8,body:9,attach:10,idClient:11,idServer:12,resend:13},sysMsg:{time:0,type:1,to:2,from:3,ps:4,attach:5,idServer:6,sendToOnlineUsersOnly:7,apnsText:8},nosToken:{objectName:1,token:2,bucket:3,expireTime:4}}},function(e,t,n){"use strict";var o=n(13),r=n(6),i={log:r.emptyFunc,debug:!1,api:"log",style:"color:blue;background:rgba(0,0,0,0.05);"},s=["log","info","warn","error"],a=["Chrome","Safari","Firefox"];i.setDebug=function(e){if(e=!!e||!1,i.debug=e,e.api&&-1!==s.indexOf(e.api)&&(i.api=e.api),e.style&&(i.style=e.style),i.debug&&window.console&&console[i.api])if("function"==typeof console[i.api].apply)i.log=function(){var e=[].slice.call(arguments,0);i.formatArgs(e),-1!==a.indexOf(o.name)&&r.isString(e[0])&&(e[0]="%c"+e[0],e.splice(1,0,i.style)),console[i.api].apply(console,e)};else switch(i.api){case"debug":i.log=function(){var e=[].slice.call(arguments,0);i.formatArgs(e);for(var t=0,n=e.length;n>t;t++)console.debug(JSON.stringify(e[t]))};break;case"log":i.log=function(){var e=[].slice.call(arguments,0);i.formatArgs(e);for(var t=0,n=e.length;n>t;t++)console.log(JSON.stringify(e[t]))};break;case"info":i.log=function(){var e=[].slice.call(arguments,0);i.formatArgs(e);for(var t=0,n=e.length;n>t;t++)console.info(JSON.stringify(e[t]))};break;case"warn":i.log=function(){var e=[].slice.call(arguments,0);i.formatArgs(e);for(var t=0,n=e.length;n>t;t++)console.warn(JSON.stringify(e[t]))};break;case"error":i.log=function(){var e=[].slice.call(arguments,0);i.formatArgs(e);for(var t=0,n=e.length;n>t;t++)console.error(JSON.stringify(e[t]))}}else i.log=r.emptyFunc},i.formatArgs=function(e){var t=new Date,n=t.getFullYear()+"-"+c(t.getMonth()+1)+"-"+c(t.getDate())+" "+c(t.getHours())+":"+c(t.getMinutes())+":"+c(t.getSeconds())+":"+c(t.getMilliseconds(),3),o="[NIM SDK LOG "+ +t+" "+n+"]	";r.isString(e[0])?e[0]=o+e[0]:e.splice(0,0,o)};var c=function(e,t){t=t||2;for(var n=""+e;n.length<t;)n="0"+n;return n};e.exports=i},function(e,t,n){var o;(function(e,r){(function(){"use strict";function i(e){return e=String(e),e.charAt(0).toUpperCase()+e.slice(1)}function s(e,t,n){var o={6.4:"10",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return t&&n&&/^Win/i.test(e)&&(o=o[/[\d.]+$/.exec(e)])&&(e="Windows "+o),e=String(e),t&&n&&(e=e.replace(RegExp(t,"i"),n)),e=c(e.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").split(" on ")[0])}function a(e,t){var n=-1,o=e?e.length:0;if("number"==typeof o&&o>-1&&w>=o)for(;++n<o;)t(e[n],n,e);else p(e,t)}function c(e){return e=m(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:i(e)}function p(e,t){for(var n in e)I.call(e,n)&&t(e[n],n,e)}function l(e){return null==e?i(e):C.call(e).slice(8,-1)}function u(e,t){var n=null!=e?typeof e[t]:"number";return!/^(?:boolean|number|string|undefined)$/.test(n)&&("object"==n?!!e[t]:!0)}function d(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function f(e,t){var n=null;return a(e,function(o,r){n=t(n,o,r,e)}),n}function m(e){return String(e).replace(/^ +| +$/g,"")}function y(e){function t(t){return f(t,function(t,n){return t||RegExp("\\b"+(n.pattern||d(n))+"\\b","i").exec(e)&&(n.label||n)})}function n(t){return f(t,function(t,n,o){return t||(n[K]||n[/^[a-z]+(?: +[a-z]+\b)*/i.exec(K)]||RegExp("\\b"+d(o)+"(?:\\b|\\w*\\d)","i").exec(e))&&o})}function o(t){return f(t,function(t,n){return t||RegExp("\\b"+(n.pattern||d(n))+"\\b","i").exec(e)&&(n.label||n)})}function r(t){return f(t,function(t,n){var o=n.pattern||d(n);return!t&&(t=RegExp("\\b"+o+"(?:/[\\d.]+|[ \\w.]*)","i").exec(e))&&(t=s(t,o,n.label||n)),t})}function i(t){return f(t,function(t,n){var o=n.pattern||d(n);return!t&&(t=RegExp("\\b"+o+" *\\d+[.\\w_]*","i").exec(e)||RegExp("\\b"+o+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(e))&&((t=String(n.label&&!RegExp(o,"i").test(n.label)?n.label:t).split("/"))[1]&&!/[\d.]+/.test(t[0])&&(t[0]+=" "+t[1]),n=n.label||n,t=c(t[0].replace(RegExp(o,"i"),n).replace(RegExp("; *(?:"+n+"[_-])?","i")," ").replace(RegExp("("+n+")[-_.]?(\\w)","i"),"$1 $2"))),t})}function a(t){return f(t,function(t,n){return t||(RegExp(n+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(e)||0)[1]||null})}function h(){return this.description||""}var g=v,k=e&&"object"==typeof e&&"String"!=l(e);k&&(g=e,e=null);var T=g.navigator||{},w=T.userAgent||"";e||(e=w);var M,I,x=k||O==b,E=k?!!T.likeChrome:/\bChrome\b/.test(e)&&!/internal|\n/i.test(C.toString()),_="Object",j=k?_:"ScriptBridgingProxyObject",A=k?_:"Environment",P=k&&g.java?"JavaPackage":l(g.java),N=k?_:"RuntimeObject",R=/\bJava/.test(P)&&g.java,D=R&&l(g.environment)==A,W=R?"a":"α",F=R?"b":"β",L=g.document||{},B=g.operamini||g.opera,U=S.test(U=k&&B?B["[[Class]]"]:l(B))?U:B=null,$=e,H=[],X=null,q=e==w,V=q&&B&&"function"==typeof B.version&&B.version(),z=t(["Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),J=o(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel",{label:"SRWare Iron",pattern:"Iron"},"K-Meleon","Konqueror","Lunascape","Maxthon","Midori","Nook Browser","PhantomJS","Raven","Rekonq","RockMelt","SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser","Sunrise","Swiftfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),K=i([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nook","PlayBook","PlayStation 4","PlayStation 3","PlayStation Vita","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),G=n({Apple:{iPad:1,iPhone:1,iPod:1},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{"PlayStation 4":1,"PlayStation 3":1,"PlayStation Vita":1}}),Z=r(["Windows Phone ","Android","CentOS","Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);if(z&&(z=[z]),G&&!K&&(K=i([G])),(M=/\bGoogle TV\b/.exec(K))&&(K=M[0]),/\bSimulator\b/i.test(e)&&(K=(K?K+" ":"")+"Simulator"),"Opera Mini"==J&&/\bOPiOS\b/.test(e)&&H.push("running in Turbo/Uncompressed mode"),/^iP/.test(K)?(J||(J="Safari"),Z="iOS"+((M=/ OS ([\d_]+)/i.exec(e))?" "+M[1].replace(/_/g,"."):"")):"Konqueror"!=J||/buntu/i.test(Z)?G&&"Google"!=G&&(/Chrome/.test(J)&&!/\bMobile Safari\b/i.test(e)||/\bVita\b/.test(K))?(J="Android Browser",Z=/\bAndroid\b/.test(Z)?Z:"Android"):(!J||(M=!/\bMinefield\b|\(Android;/i.test(e)&&/\b(?:Firefox|Safari)\b/.exec(J)))&&(J&&!K&&/[\/,]|^[^(]+?\)/.test(e.slice(e.indexOf(M+"/")+8))&&(J=null),(M=K||G||Z)&&(K||G||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(Z))&&(J=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(Z)?Z:M)+" Browser")):Z="Kubuntu",(M=/\((Mobile|Tablet).*?Firefox\b/i.exec(e))&&M[1]&&(Z="Firefox OS",K||(K=M[1])),V||(V=a(["(?:Cloud9|CriOS|CrMo|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|Silk(?!/[\\d.]+$))","Version",d(J),"(?:Firefox|Minefield|NetFront)"])),"iCab"==z&&parseFloat(V)>3?z=["WebKit"]:"Trident"!=z&&(M=/\bOpera\b/.test(J)&&(/\bOPR\b/.test(e)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(e)&&"WebKit"||!z&&/\bMSIE\b/i.test(e)&&("Mac OS"==Z?"Tasman":"Trident"))?z=[M]:/\bPlayStation\b(?! Vita\b)/i.test(J)&&"WebKit"==z&&(z=["NetFront"]),"IE"==J&&(M=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(e)||0)[1])?(J+=" Mobile",Z="Windows Phone "+(/\+$/.test(M)?M:M+".x"),H.unshift("desktop mode")):/\bWPDesktop\b/i.test(e)?(J="IE Mobile",Z="Windows Phone 8+",H.unshift("desktop mode"),V||(V=(/\brv:([\d.]+)/.exec(e)||0)[1])):"IE"!=J&&"Trident"==z&&(M=/\brv:([\d.]+)/.exec(e))?(/\bWPDesktop\b/i.test(e)||(J&&H.push("identifying as "+J+(V?" "+V:"")),J="IE"),V=M[1]):"Chrome"!=J&&"IE"==J||!(M=/\bEdge\/([\d.]+)/.exec(e))||(J="IE",V=M[1],z=["Trident"],H.unshift("platform preview")),q){if(u(g,"global"))if(R&&(M=R.lang.System,$=M.getProperty("os.arch"),Z=Z||M.getProperty("os.name")+" "+M.getProperty("os.version")),x&&u(g,"system")&&(M=[g.system])[0]){Z||(Z=M[0].os||null);try{M[1]=g.require("ringo/engine").version,V=M[1].join("."),J="RingoJS"}catch(Q){M[0].global.system==g.system&&(J="Narwhal")}}else"object"==typeof g.process&&(M=g.process)?(J="Node.js",$=M.arch,Z=M.platform,V=/[\d.]+/.exec(M.version)[0]):D&&(J="Rhino");else l(M=g.runtime)==j?(J="Adobe AIR",Z=M.flash.system.Capabilities.os):l(M=g.phantom)==N?(J="PhantomJS",V=(M=M.version||null)&&M.major+"."+M.minor+"."+M.patch):"number"==typeof L.documentMode&&(M=/\bTrident\/(\d+)/i.exec(e))&&(V=[V,L.documentMode],(M=+M[1]+4)!=V[1]&&(H.push("IE "+V[1]+" mode"),z&&(z[1]=""),V[1]=M),V="IE"==J?String(V[1].toFixed(1)):V[0]);Z=Z&&c(Z)}V&&(M=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(V)||/(?:alpha|beta)(?: ?\d)?/i.exec(e+";"+(q&&T.appMinorVersion))||/\bMinefield\b/i.test(e)&&"a")&&(X=/b/i.test(M)?"beta":"alpha",V=V.replace(RegExp(M+"\\+?$"),"")+("beta"==X?F:W)+(/\d+\+?/.exec(M)||"")),"Fennec"==J||"Firefox"==J&&/\b(?:Android|Firefox OS)\b/.test(Z)?J="Firefox Mobile":"Maxthon"==J&&V?V=V.replace(/\.[\d.]+/,".x"):"Silk"==J?(/\bMobi/i.test(e)||(Z="Android",H.unshift("desktop mode")),/Accelerated *= *true/i.test(e)&&H.unshift("accelerated")):/\bXbox\b/i.test(K)?(Z=null,"Xbox 360"==K&&/\bIEMobile\b/.test(e)&&H.unshift("mobile mode")):!/^(?:Chrome|IE|Opera)$/.test(J)&&(!J||K||/Browser|Mobi/.test(J))||"Windows CE"!=Z&&!/Mobi/i.test(e)?"IE"==J&&q&&null===g.external?H.unshift("platform preview"):(/\bBlackBerry\b/.test(K)||/\bBB10\b/.test(e))&&(M=(RegExp(K.replace(/ +/g," *")+"/([.\\d]+)","i").exec(e)||0)[1]||V)?(M=[M,/BB10/.test(e)],Z=(M[1]?(K=null,G="BlackBerry"):"Device Software")+" "+M[0],V=null):this!=p&&"Wii"!=K&&(q&&B||/Opera/.test(J)&&/\b(?:MSIE|Firefox)\b/i.test(e)||"Firefox"==J&&/\bOS X (?:\d+\.){2,}/.test(Z)||"IE"==J&&(Z&&!/^Win/.test(Z)&&V>5.5||/\bWindows XP\b/.test(Z)&&V>8||8==V&&!/\bTrident\b/.test(e)))&&!S.test(M=y.call(p,e.replace(S,"")+";"))&&M.name&&(M="ing as "+M.name+((M=M.version)?" "+M:""),S.test(J)?(/\bIE\b/.test(M)&&"Mac OS"==Z&&(Z=null),M="identify"+M):(M="mask"+M,J=U?c(U.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(M)&&(Z=null),q||(V=null)),z=["Presto"],H.push(M)):J+=" Mobile",(M=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(e)||0)[1])&&(M=[parseFloat(M.replace(/\.(\d)$/,".0$1")),M],"Safari"==J&&"+"==M[1].slice(-1)?(J="WebKit Nightly",X="alpha",V=M[1].slice(0,-1)):(V==M[1]||V==(M[2]=(/\bSafari\/([\d.]+\+?)/i.exec(e)||0)[1]))&&(V=null),M[1]=(/\bChrome\/([\d.]+)/i.exec(e)||0)[1],537.36==M[0]&&537.36==M[2]&&parseFloat(M[1])>=28&&"IE"!=J&&(z=["Blink"]),q&&(E||M[1])?(z&&(z[1]="like Chrome"),M=M[1]||(M=M[0],530>M?1:532>M?2:532.05>M?3:533>M?4:534.03>M?5:534.07>M?6:534.1>M?7:534.13>M?8:534.16>M?9:534.24>M?10:534.3>M?11:535.01>M?12:535.02>M?"13+":535.07>M?15:535.11>M?16:535.19>M?17:536.05>M?18:536.1>M?19:537.01>M?20:537.11>M?"21+":537.13>M?23:537.18>M?24:537.24>M?25:537.36>M?26:"Blink"!=z?"27":"28")):(z&&(z[1]="like Safari"),M=M[0],M=400>M?1:500>M?2:526>M?3:533>M?4:534>M?"4+":535>M?5:537>M?6:538>M?7:601>M?8:"8"),z&&(z[1]+=" "+(M+="number"==typeof M?".x":/[.+]/.test(M)?"":"+")),"Safari"==J&&(!V||parseInt(V)>45)&&(V=M)),"Opera"==J&&(M=/\bzbov|zvav$/.exec(Z))?(J+=" ",H.unshift("desktop mode"),"zvav"==M?(J+="Mini",V=null):J+="Mobile",Z=Z.replace(RegExp(" *"+M+"$"),"")):"Safari"==J&&/\bChrome\b/.exec(z&&z[1])&&(H.unshift("desktop mode"),J="Chrome Mobile",V=null,/\bOS X\b/.test(Z)?(G="Apple",Z="iOS 4.3+"):Z=null),V&&0==V.indexOf(M=/[\d.]+$/.exec(Z))&&e.indexOf("/"+M+"-")>-1&&(Z=m(Z.replace(M,""))),z&&!/\b(?:Avant|Nook)\b/.test(J)&&(/Browser|Lunascape|Maxthon/.test(J)||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Sleipnir|Web)/.test(J)&&z[1])&&(M=z[z.length-1])&&H.push(M),H.length&&(H=["("+H.join("; ")+")"]),G&&K&&K.indexOf(G)<0&&H.push("on "+G),K&&H.push((/^on /.test(H[H.length-1])?"":"on ")+K),Z&&(M=/ ([\d.+]+)$/.exec(Z),I=M&&"/"==Z.charAt(Z.length-M[0].length-1),Z={architecture:32,family:M&&!I?Z.replace(M[0],""):Z,version:M?M[1]:null,toString:function(){var e=this.version;return this.family+(e&&!I?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(M=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec($))&&!/\bi686\b/i.test($)&&(Z&&(Z.architecture=64,Z.family=Z.family.replace(RegExp(" *"+M),"")),J&&(/\bWOW64\b/i.test(e)||q&&/\w(?:86|32)$/.test(T.cpuClass||T.platform)&&!/\bWin64; x64\b/i.test(e))&&H.unshift("32-bit")),e||(e=null);var Y={};return Y.description=e,Y.layout=z&&z[0],Y.manufacturer=G,Y.name=J,Y.prerelease=X,Y.product=K,Y.ua=e,Y.version=J&&V,Y.os=Z||{architecture:null,family:null,version:null,toString:function(){return"null"}},Y.parse=y,Y.toString=h,Y.version&&H.unshift(V),Y.name&&H.unshift(J),Z&&J&&(Z!=String(Z).split(" ")[0]||Z!=J.split(" ")[0]&&!K)&&H.push(K?"("+Z+")":"on "+Z),H.length&&(Y.description=H.join(" ")),Y}var h={"function":!0,object:!0},v=h[typeof window]&&window||this,b=v,g=h[typeof t]&&t,k=h[typeof e]&&e&&!e.nodeType&&e,T=g&&k&&"object"==typeof r&&r;!T||T.global!==T&&T.window!==T&&T.self!==T||(v=T);var w=Math.pow(2,53)-1,S=/\bOpera/,O=this,M=Object.prototype,I=M.hasOwnProperty,C=M.toString;o=function(){return y()}.call(t,n,t,e),!(void 0!==o&&(e.exports=o))}).call(this)}).call(t,n(14)(e),function(){return this}())},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t,n){"use strict";function o(e){switch(r.verifyOptions(e,"action"),e.action){case"create":r.verifyOptions(e,"teamId",!1),r.verifyOptions(e,"type name"),r.verifyParamValid("type",e.type,u()),"normal"===e.type&&r.verifyOptions(e,"intro announcement joinMode custom",!1);break;case"update":r.verifyOptions(e,"teamId"),r.verifyOptions(e,"type",!1)}if("undefined"!=typeof e.teamId&&(this.teamId=e.teamId),"undefined"!=typeof e.type&&(this.type=a[e.type]),"undefined"!=typeof e.name&&(this.name=""+e.name),"undefined"!=typeof e.intro&&(this.intro=""+e.intro),"undefined"!=typeof e.announcement&&(this.announcement=""+e.announcement,this.announcement.length>s))throw i.newParamError("公告长度超过"+s);"undefined"!=typeof e.joinMode&&(r.verifyParamValid("joinMode",e.joinMode,d()),this.joinMode=p[e.joinMode]),"undefined"!=typeof e.custom&&(this.custom=""+e.custom)}var r=n(6),i=n(7),s=1024,a={normal:0,advanced:1},c={0:"normal",1:"advanced"},p={noVerify:0,needVerify:1,rejectAll:2},l={0:"noVerify",1:"needVerify",2:"rejectAll"};o.reverse=function(e){var t=r.filterObj(e,"teamId appId name type owner level selfCustom valid memberNum memberUpdateTime createTime updateTime validToCurrentUser");return"undefined"!=typeof t.teamId&&(t.teamId=+t.teamId),"undefined"!=typeof t.appId&&(t.appId=+t.appId),"undefined"!=typeof t.type&&(t.type=c[t.type]),"undefined"!=typeof t.level&&(t.level=+t.level),"undefined"!=typeof t.valid&&(t.valid="1"===t.valid),"undefined"!=typeof t.memberNum&&(t.memberNum=+t.memberNum),"undefined"!=typeof t.memberUpdateTime&&(t.memberUpdateTime=+t.memberUpdateTime),"undefined"!=typeof t.createTime&&(t.createTime=+t.createTime),"undefined"!=typeof t.updateTime&&(t.updateTime=+t.updateTime),"undefined"!=typeof t.validToCurrentUser&&(t.validToCurrentUser="1"===t.validToCurrentUser),"advanced"!==t.type&&e.type||(t=r.merge(t,r.filterObj(e,"intro announcement joinMode bits custom serverCustom")),"undefined"!=typeof t.joinMode&&(t.joinMode=l[t.joinMode])),t};var u=function(){return Object.keys(a)},d=function(){return Object.keys(p)},f=function(e){return o.reverse(e)};e.exports={Team:o,reverse:f}},function(e,t,n){function o(e){}var r=(n(6),{1:"Android",2:"iOS",4:"PC",8:"WindowsPhone",16:"Web"}),i=function(e){return obj=e,obj.type=r[obj.type],obj},s=function(e){return r[e]||e};e.exports={LoginPort:o,reverse:i,reverseType:s}},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;(function(module){var io=module.exports;!function(){if(function(e,t){var n=e;n.version="0.9.11",n.protocol=1,n.transports=[],n.j=[],n.sockets={},n.connect=function(e,o){var r,i,s=n.util.parseUri(e);t&&t.location&&(s.protocol=s.protocol||t.location.protocol.slice(0,-1),s.host=s.host||(t.document?t.document.domain:t.location.hostname),s.port=s.port||t.location.port),r=n.util.uniqueUri(s);var a={host:s.host,secure:"https"==s.protocol,port:s.port||("https"==s.protocol?443:80),query:s.query||""};return n.util.merge(a,o),(a["force new connection"]||!n.sockets[r])&&(i=new n.Socket(a)),!a["force new connection"]&&i&&(n.sockets[r]=i),i=i||n.sockets[r],i.of(s.path.length>1?s.path:"")}}(module.exports,this),function(e,t){var n=e.util={},o=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];n.parseUri=function(e){for(var t=o.exec(e||""),n={},i=14;i--;)n[r[i]]=t[i]||"";return n},n.uniqueUri=function(e){var n=e.protocol,o=e.host,r=e.port;return"document"in t?(o=o||document.domain,r=r||("https"==n&&"https:"!==document.location.protocol?443:document.location.port)):(o=o||"localhost",r||"https"!=n||(r=443)),(n||"http")+"://"+o+":"+(r||80)},n.query=function(e,t){var o=n.chunkQuery(e||""),r=[];n.merge(o,n.chunkQuery(t||""));for(var i in o)o.hasOwnProperty(i)&&r.push(i+"="+o[i]);return r.length?"?"+r.join("&"):""},n.chunkQuery=function(e){for(var t,n={},o=e.split("&"),r=0,i=o.length;i>r;++r)t=o[r].split("="),t[0]&&(n[t[0]]=t[1]);return n};var i=!1;n.load=function(e){return"document"in t&&"complete"===document.readyState||i?e():void n.on(t,"load",e,!1)},n.on=function(e,t,n,o){e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener&&e.addEventListener(t,n,o)},n.request=function(e){if(e&&"undefined"!=typeof XDomainRequest&&!n.ua.hasCORS)return new XDomainRequest;if("undefined"!=typeof XMLHttpRequest&&(!e||n.ua.hasCORS))return new XMLHttpRequest;if(!e)try{return new(window[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}return null},"undefined"!=typeof window&&n.load(function(){i=!0}),n.defer=function(e){return n.ua.webkit&&"undefined"==typeof importScripts?void n.load(function(){setTimeout(e,100)}):e()},n.merge=function(e,t,o,r){var i,s=r||[],a="undefined"==typeof o?2:o;for(i in t)t.hasOwnProperty(i)&&n.indexOf(s,i)<0&&("object"==typeof e[i]&&a?n.merge(e[i],t[i],a-1,s):(e[i]=t[i],s.push(t[i])));return e},n.mixin=function(e,t){n.merge(e.prototype,t.prototype)},n.inherit=function(e,t){function n(){}n.prototype=t.prototype,e.prototype=new n},n.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},n.intersect=function(e,t){for(var o=[],r=e.length>t.length?e:t,i=e.length>t.length?t:e,s=0,a=i.length;a>s;s++)~n.indexOf(r,i[s])&&o.push(i[s]);return o},n.indexOf=function(e,t,n){for(var o=e.length,n=0>n?0>n+o?0:n+o:n||0;o>n&&e[n]!==t;n++);return n>=o?-1:n},n.toArray=function(e){for(var t=[],n=0,o=e.length;o>n;n++)t.push(e[n]);return t},n.ua={},n.ua.hasCORS="undefined"!=typeof XMLHttpRequest&&function(){try{var e=new XMLHttpRequest}catch(t){return!1}return void 0!=e.withCredentials}(),n.ua.webkit="undefined"!=typeof navigator&&/webkit/i.test(navigator.userAgent),n.ua.iDevice="undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)}("undefined"!=typeof io?io:module.exports,this),function(e,t){function n(){}e.EventEmitter=n,n.prototype.on=function(e,n){return this.$events||(this.$events={}),this.$events[e]?t.util.isArray(this.$events[e])?this.$events[e].push(n):this.$events[e]=[this.$events[e],n]:this.$events[e]=n,this},n.prototype.addListener=n.prototype.on,n.prototype.once=function(e,t){function n(){o.removeListener(e,n),t.apply(this,arguments)}var o=this;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,n){if(this.$events&&this.$events[e]){var o=this.$events[e];if(t.util.isArray(o)){for(var r=-1,i=0,s=o.length;s>i;i++)if(o[i]===n||o[i].listener&&o[i].listener===n){r=i;break}if(0>r)return this;o.splice(r,1),o.length||delete this.$events[e]}else(o===n||o.listener&&o.listener===n)&&delete this.$events[e]}return this},n.prototype.removeAllListeners=function(e){return void 0===e?(this.$events={},this):(this.$events&&this.$events[e]&&(this.$events[e]=null),this)},n.prototype.listeners=function(e){return this.$events||(this.$events={}),this.$events[e]||(this.$events[e]=[]),t.util.isArray(this.$events[e])||(this.$events[e]=[this.$events[e]]),this.$events[e]},n.prototype.emit=function(e){if(!this.$events)return!1;var n=this.$events[e];if(!n)return!1;var o=Array.prototype.slice.call(arguments,1);if("function"==typeof n)n.apply(this,o);else{if(!t.util.isArray(n))return!1;for(var r=n.slice(),i=0,s=r.length;s>i;i++)r[i].apply(this,o)}return!0}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(exports,nativeJSON){"use strict";function f(e){return 10>e?"0"+e:e}function date(e,t){return isFinite(e.valueOf())?e.getUTCFullYear()+"-"+f(e.getUTCMonth()+1)+"-"+f(e.getUTCDate())+"T"+f(e.getUTCHours())+":"+f(e.getUTCMinutes())+":"+f(e.getUTCSeconds())+"Z":null}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,o,r,i,s,a=gap,c=t[e];switch(c instanceof Date&&(c=date(e)),"function"==typeof rep&&(c=rep.call(t,e,c)),typeof c){case"string":return quote(c);case"number":return isFinite(c)?String(c):"null";case"boolean":case"null":return String(c);case"object":if(!c)return"null";if(gap+=indent,s=[],"[object Array]"===Object.prototype.toString.apply(c)){for(i=c.length,n=0;i>n;n+=1)s[n]=str(n,c)||"null";return r=0===s.length?"[]":gap?"[\n"+gap+s.join(",\n"+gap)+"\n"+a+"]":"["+s.join(",")+"]",gap=a,r}if(rep&&"object"==typeof rep)for(i=rep.length,n=0;i>n;n+=1)"string"==typeof rep[n]&&(o=rep[n],r=str(o,c),r&&s.push(quote(o)+(gap?": ":":")+r));else for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(r=str(o,c),r&&s.push(quote(o)+(gap?": ":":")+r));return r=0===s.length?"{}":gap?"{\n"+gap+s.join(",\n"+gap)+"\n"+a+"}":"{"+s.join(",")+"}",gap=a,r}}if(nativeJSON&&nativeJSON.parse)return exports.JSON={parse:nativeJSON.parse,stringify:nativeJSON.stringify};var JSON=exports.JSON={},cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;JSON.stringify=function(e,t,n){var o;if(gap="",indent="","number"==typeof n)for(o=0;n>o;o+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})},JSON.parse=function(text,reviver){function walk(e,t){var n,o,r=e[t];if(r&&"object"==typeof r)for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(o=walk(r,n),void 0!==o?r[n]=o:delete r[n]);return reviver.call(e,t,r)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof JSON?JSON:void 0),function(e,t){var n=e.parser={},o=n.packets=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],r=n.reasons=["transport not supported","client not handshaken","unauthorized"],i=n.advice=["reconnect"],s=t.JSON,a=t.util.indexOf;n.encodePacket=function(e){var t=a(o,e.type),n=e.id||"",c=e.endpoint||"",p=e.ack,l=null;switch(e.type){case"error":var u=e.reason?a(r,e.reason):"",d=e.advice?a(i,e.advice):"";(""!==u||""!==d)&&(l=u+(""!==d?"+"+d:""));break;case"message":""!==e.data&&(l=e.data);break;case"event":var f={name:e.name};e.args&&e.args.length&&(f.args=e.args),l=s.stringify(f);break;case"json":l=s.stringify(e.data);break;case"connect":e.qs&&(l=e.qs);break;case"ack":l=e.ackId+(e.args&&e.args.length?"+"+s.stringify(e.args):"")}var m=[t,n+("data"==p?"+":""),c];return null!==l&&void 0!==l&&m.push(l),m.join(":")},n.encodePayload=function(e){var t="";if(1==e.length)return e[0];for(var n=0,o=e.length;o>n;n++){var r=e[n];t+="�"+r.length+"�"+e[n]}return t};var c=/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/;n.decodePacket=function(e){var t=e.match(c);if(!t)return{};var n=t[2]||"",e=t[5]||"",a={type:o[t[1]],endpoint:t[4]||""};switch(n&&(a.id=n,a.ack=t[3]?"data":!0),a.type){case"error":var t=e.split("+");a.reason=r[t[0]]||"",a.advice=i[t[1]]||"";break;case"message":a.data=e||"";break;case"event":try{var p=s.parse(e);a.name=p.name,a.args=p.args}catch(l){}a.args=a.args||[];break;case"json":try{a.data=s.parse(e)}catch(l){}break;case"connect":a.qs=e||"";break;case"ack":var t=e.match(/^([0-9]+)(\+)?(.*)/);if(t&&(a.ackId=t[1],a.args=[],t[3]))try{a.args=t[3]?s.parse(t[3]):[]}catch(l){}break;case"disconnect":case"heartbeat":}return a},n.decodePayload=function(e){var t=function(e,t){for(var n=0,o=e;o<t.length;o++){if("�"==t.charAt(o))return n;n++}return n};if("�"==e.charAt(0)){for(var o=[],r=1,i="";r<e.length;r++)if("�"==e.charAt(r)){var s=e.substr(r+1).substr(0,i);if("�"!=e.charAt(r+1+Number(i))&&r+1+Number(i)!=e.length){var a=Number(i);l=t(r+a+1,e),s=e.substr(r+1).substr(0,a+l),r+=l}o.push(n.decodePacket(s)),r+=Number(i)+1,i=""}else i+=e.charAt(r);return o}return[n.decodePacket(e)]}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t){function n(e,t){this.socket=e,this.sessid=t}e.Transport=n,t.util.mixin(n,t.EventEmitter),n.prototype.heartbeats=function(){return!0},n.prototype.onData=function(e){if(this.clearCloseTimeout(),(this.socket.connected||this.socket.connecting||this.socket.reconnecting)&&this.setCloseTimeout(),""!==e){var n=t.parser.decodePayload(e);if(n&&n.length)for(var o=0,r=n.length;r>o;o++)this.onPacket(n[o])}return this},n.prototype.onPacket=function(e){return this.socket.setHeartbeatTimeout(),"heartbeat"==e.type?this.onHeartbeat():("connect"==e.type&&""==e.endpoint&&this.onConnect(),"error"==e.type&&"reconnect"==e.advice&&(this.isOpen=!1),this.socket.onPacket(e),this)},n.prototype.setCloseTimeout=function(){if(!this.closeTimeout){var e=this;this.closeTimeout=setTimeout(function(){e.onDisconnect()},this.socket.closeTimeout)}},n.prototype.onDisconnect=function(){return this.isOpen&&this.close(),this.clearTimeouts(),this.socket.onDisconnect(),this},n.prototype.onConnect=function(){return this.socket.onConnect(),this},n.prototype.clearCloseTimeout=function(){this.closeTimeout&&(clearTimeout(this.closeTimeout),this.closeTimeout=null)},n.prototype.clearTimeouts=function(){this.clearCloseTimeout(),this.reopenTimeout&&clearTimeout(this.reopenTimeout)},n.prototype.packet=function(e){this.send(t.parser.encodePacket(e))},n.prototype.onHeartbeat=function(e){this.packet({type:"heartbeat"})},n.prototype.onOpen=function(){this.isOpen=!0,this.clearCloseTimeout(),this.socket.onOpen()},n.prototype.onClose=function(){this.isOpen=!1,this.socket.onClose(),this.onDisconnect()},n.prototype.prepareUrl=function(){var e=this.socket.options;return this.scheme()+"://"+e.host+":"+e.port+"/"+e.resource+"/"+t.protocol+"/"+this.name+"/"+this.sessid},n.prototype.ready=function(e,t){t.call(this)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t,n){function o(e){if(this.options={port:80,secure:!1,document:"document"in n?document:!1,resource:"socket.io",transports:t.transports,"connect timeout":1e4,"try multiple transports":!0,reconnect:!0,"reconnection delay":500,"reconnection limit":1/0,"reopen delay":3e3,"max reconnection attempts":10,"sync disconnect on unload":!1,"auto connect":!0,"flash policy port":10843,manualFlush:!1},t.util.merge(this.options,e),this.connected=!1,this.open=!1,this.connecting=!1,this.reconnecting=!1,this.namespaces={},this.buffer=[],this.doBuffer=!1,this.options["sync disconnect on unload"]&&(!this.isXDomain()||t.util.ua.hasCORS)){var o=this;t.util.on(n,"beforeunload",function(){o.disconnectSync()},!1)}this.options["auto connect"]&&this.connect()}function r(){}e.Socket=o,t.util.mixin(o,t.EventEmitter),o.prototype.of=function(e){return this.namespaces[e]||(this.namespaces[e]=new t.SocketNamespace(this,e),""!==e&&this.namespaces[e].packet({type:"connect"})),this.namespaces[e]},o.prototype.publish=function(){this.emit.apply(this,arguments);var e;for(var t in this.namespaces)this.namespaces.hasOwnProperty(t)&&(e=this.of(t),e.$emit.apply(e,arguments))},o.prototype.handshake=function(e){function n(t){t instanceof Error?(o.connecting=!1,o.onError(t.message)):e.apply(null,t.split(":"))}var o=this,i=this.options,s=["http"+(i.secure?"s":"")+":/",i.host+":"+i.port,i.resource,t.protocol,t.util.query(this.options.query,"t="+ +new Date)].join("/");if(this.isXDomain()&&!t.util.ua.hasCORS){var a=document.getElementsByTagName("script")[0],c=document.createElement("script");c.src=s+"&jsonp="+t.j.length,c.onreadystatechange=function(){"loaded"==this.readyState&&c.parentNode&&(c.parentNode.removeChild(c),
o.connecting=!1,!o.reconnecting&&o.onError("Server down or port not open"))},a.parentNode.insertBefore(c,a),t.j.push(function(e){n(e),c.parentNode.removeChild(c)})}else{var p=t.util.request();p.open("GET",s,!0),this.isXDomain()&&(p.withCredentials=!0),p.onreadystatechange=function(){4==p.readyState&&(p.onreadystatechange=r,200==p.status?n(p.responseText):403==p.status?o.onError(p.responseText):(o.connecting=!1,!o.reconnecting&&o.onError(p.responseText)))},p.send(null)}},o.prototype.getTransport=function(e){for(var n,o=e||this.transports,r=0;n=o[r];r++)if(t.Transport[n]&&t.Transport[n].check(this)&&(!this.isXDomain()||t.Transport[n].xdomainCheck(this))){var i=new t.Transport[n](this,this.sessionid);return i}return null},o.prototype.connect=function(e){if(this.connecting)return this;var n=this;return n.connecting=!0,this.handshake(function(o,r,i,s){function a(e){return n.transport&&n.transport.clearTimeouts(),n.transport=n.getTransport(e),n.transport?void n.transport.ready(n,function(){n.connecting=!0,n.publish("connecting",n.transport.name),n.transport.open(),n.options["connect timeout"]&&(n.connectTimeoutTimer=setTimeout(function(){if(!n.connected&&(n.connecting=!1,n.options["try multiple transports"])){for(var e=n.transports;e.length>0&&e.splice(0,1)[0]!=n.transport.name;);e.length?a(e):n.publish("connect_failed")}},n.options["connect timeout"]))}):n.publish("connect_failed")}n.sessionid=o,n.closeTimeout=1e3*i,n.heartbeatTimeout=1e3*r,n.transports||(n.transports=n.origTransports=s?t.util.intersect(s.split(","),n.options.transports):n.options.transports),n.setHeartbeatTimeout(),a(n.transports),n.once("connect",function(){clearTimeout(n.connectTimeoutTimer),e&&"function"==typeof e&&e()})}),this},o.prototype.setHeartbeatTimeout=function(){if(clearTimeout(this.heartbeatTimeoutTimer),!this.transport||this.transport.heartbeats()){var e=this;this.heartbeatTimeoutTimer=setTimeout(function(){e.transport.onClose()},this.heartbeatTimeout)}},o.prototype.packet=function(e){return this.connected&&!this.doBuffer?this.transport.packet(e):this.buffer.push(e),this},o.prototype.setBuffer=function(e){this.doBuffer=e,!e&&this.connected&&this.buffer.length&&(this.options.manualFlush||this.flushBuffer())},o.prototype.flushBuffer=function(){this.transport.payload(this.buffer),this.buffer=[]},o.prototype.disconnect=function(){return(this.connected||this.connecting)&&(this.open&&this.of("").packet({type:"disconnect"}),this.onDisconnect("booted")),this},o.prototype.disconnectSync=function(){var e=t.util.request(),n=["http"+(this.options.secure?"s":"")+":/",this.options.host+":"+this.options.port,this.options.resource,t.protocol,"",this.sessionid].join("/")+"/?disconnect=1";e.open("GET",n,!1),e.send(null),this.onDisconnect("booted")},o.prototype.isXDomain=function(){var e=n.location.port||("https:"==n.location.protocol?443:80);return this.options.host!==n.location.hostname||this.options.port!=e},o.prototype.onConnect=function(){this.connected||(this.connected=!0,this.connecting=!1,this.doBuffer||this.setBuffer(!1),this.emit("connect"))},o.prototype.onOpen=function(){this.open=!0},o.prototype.onClose=function(){this.open=!1,clearTimeout(this.heartbeatTimeoutTimer)},o.prototype.onPacket=function(e){this.of(e.endpoint).onPacket(e)},o.prototype.onError=function(e){e&&e.advice&&"reconnect"===e.advice&&(this.connected||this.connecting)&&(this.disconnect(),this.options.reconnect&&this.reconnect()),this.publish("error",e&&e.reason?e.reason:e)},o.prototype.onDisconnect=function(e){var t=this.connected,n=this.connecting;this.connected=!1,this.connecting=!1,this.open=!1,(t||n)&&(this.transport.close(),this.transport.clearTimeouts(),t&&(this.publish("disconnect",e),"booted"!=e&&this.options.reconnect&&!this.reconnecting&&this.reconnect()))},o.prototype.reconnect=function(){function e(){if(n.connected){for(var e in n.namespaces)n.namespaces.hasOwnProperty(e)&&""!==e&&n.namespaces[e].packet({type:"connect"});n.publish("reconnect",n.transport.name,n.reconnectionAttempts)}clearTimeout(n.reconnectionTimer),n.removeListener("connect_failed",t),n.removeListener("connect",t),n.reconnecting=!1,delete n.reconnectionAttempts,delete n.reconnectionDelay,delete n.reconnectionTimer,delete n.redoTransports,n.options["try multiple transports"]=r}function t(){return n.reconnecting?n.connected?e():n.connecting&&n.reconnecting?n.reconnectionTimer=setTimeout(t,1e3):void(n.reconnectionAttempts++>=o?n.redoTransports?(n.publish("reconnect_failed"),e()):(n.on("connect_failed",t),n.options["try multiple transports"]=!0,n.transports=n.origTransports,n.transport=n.getTransport(),n.redoTransports=!0,n.connect()):(n.reconnectionDelay<i&&(n.reconnectionDelay*=2),n.connect(),n.publish("reconnecting",n.reconnectionDelay,n.reconnectionAttempts),n.reconnectionTimer=setTimeout(t,n.reconnectionDelay))):void 0}this.reconnecting=!0,this.reconnectionAttempts=0,this.reconnectionDelay=this.options["reconnection delay"];var n=this,o=this.options["max reconnection attempts"],r=this.options["try multiple transports"],i=this.options["reconnection limit"];this.options["try multiple transports"]=!1,this.reconnectionTimer=setTimeout(t,this.reconnectionDelay),this.on("connect",t)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,t){function n(e,t){this.socket=e,this.name=t||"",this.flags={},this.json=new o(this,"json"),this.ackPackets=0,this.acks={}}function o(e,t){this.namespace=e,this.name=t}e.SocketNamespace=n,t.util.mixin(n,t.EventEmitter),n.prototype.$emit=t.EventEmitter.prototype.emit,n.prototype.of=function(){return this.socket.of.apply(this.socket,arguments)},n.prototype.packet=function(e){return e.endpoint=this.name,this.socket.packet(e),this.flags={},this},n.prototype.send=function(e,t){var n={type:this.flags.json?"json":"message",data:e};return"function"==typeof t&&(n.id=++this.ackPackets,n.ack=!0,this.acks[n.id]=t),this.packet(n)},n.prototype.emit=function(e){var t=Array.prototype.slice.call(arguments,1),n=t[t.length-1],o={type:"event",name:e};return"function"==typeof n&&(o.id=++this.ackPackets,o.ack="data",this.acks[o.id]=n,t=t.slice(0,t.length-1)),o.args=t,this.packet(o)},n.prototype.disconnect=function(){return""===this.name?this.socket.disconnect():(this.packet({type:"disconnect"}),this.$emit("disconnect")),this},n.prototype.onPacket=function(e){function n(){o.packet({type:"ack",args:t.util.toArray(arguments),ackId:e.id})}var o=this;switch(e.type){case"connect":this.$emit("connect");break;case"disconnect":""===this.name?this.socket.onDisconnect(e.reason||"booted"):this.$emit("disconnect",e.reason);break;case"message":case"json":var r=["message",e.data];"data"==e.ack?r.push(n):e.ack&&this.packet({type:"ack",ackId:e.id}),this.$emit.apply(this,r);break;case"event":var r=[e.name].concat(e.args);"data"==e.ack&&r.push(n),this.$emit.apply(this,r);break;case"ack":this.acks[e.ackId]&&(this.acks[e.ackId].apply(this,e.args),delete this.acks[e.ackId]);break;case"error":e.advice?this.socket.onError(e):"unauthorized"==e.reason?this.$emit("connect_failed",e.reason):this.$emit("error",e.reason)}},o.prototype.send=function(){this.namespace.flags[this.name]=!0,this.namespace.send.apply(this.namespace,arguments)},o.prototype.emit=function(){this.namespace.flags[this.name]=!0,this.namespace.emit.apply(this.namespace,arguments)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t,n){function o(e){t.Transport.apply(this,arguments)}e.websocket=o,t.util.inherit(o,t.Transport),o.prototype.name="websocket",o.prototype.open=function(){var e,o=t.util.query(this.socket.options.query),r=this;return e||(e=n.MozWebSocket||n.WebSocket),this.websocket=new e(this.prepareUrl()+o),this.websocket.onopen=function(){r.onOpen(),r.socket.setBuffer(!1)},this.websocket.onmessage=function(e){r.onData(e.data)},this.websocket.onclose=function(){r.onClose(),r.socket.setBuffer(!0)},this.websocket.onerror=function(e){r.onError(e)},this},o.prototype.send=t.util.ua.iDevice?function(e){var t=this;return setTimeout(function(){t.websocket.send(e)},0),this}:function(e){return this.websocket.send(e),this},o.prototype.payload=function(e){for(var t=0,n=e.length;n>t;t++)this.packet(e[t]);return this},o.prototype.close=function(){return this.websocket.close(),this},o.prototype.onError=function(e){this.socket.onError(e)},o.prototype.scheme=function(){return this.socket.options.secure?"wss":"ws"},o.check=function(){return"WebSocket"in n&&!("__addTask"in WebSocket)||"MozWebSocket"in n},o.xdomainCheck=function(){return!0},t.transports.push("websocket")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,t){function n(){t.Transport.websocket.apply(this,arguments)}e.flashsocket=n,t.util.inherit(n,t.Transport.websocket),n.prototype.name="flashsocket",n.prototype.open=function(){var e=this,n=arguments;return WebSocket.__addTask(function(){t.Transport.websocket.prototype.open.apply(e,n)}),this},n.prototype.send=function(){var e=this,n=arguments;return WebSocket.__addTask(function(){t.Transport.websocket.prototype.send.apply(e,n)}),this},n.prototype.close=function(){return WebSocket.__tasks.length=0,t.Transport.websocket.prototype.close.call(this),this},n.prototype.ready=function(e,o){function r(){var t=e.options,r=t["flash policy port"],s=["http"+(t.secure?"s":"")+":/",t.host+":"+t.port,t.resource,"static/flashsocket","WebSocketMain"+(e.isXDomain()?"Insecure":"")+".swf"];n.loaded||("undefined"==typeof WEB_SOCKET_SWF_LOCATION&&(WEB_SOCKET_SWF_LOCATION=s.join("/")),843!==r&&WebSocket.loadFlashPolicyFile("xmlsocket://"+t.host+":"+r),WebSocket.__initialize(),n.loaded=!0),o.call(i)}var i=this;return document.body?r():void t.util.load(r)},n.check=function(){return"undefined"!=typeof WebSocket&&"__initialize"in WebSocket&&swfobject?swfobject.getFlashPlayerVersion().major>=10:!1},n.xdomainCheck=function(){return!0},"undefined"!=typeof window&&(WEB_SOCKET_DISABLE_AUTO_INITIALIZATION=!0),t.transports.push("flashsocket")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports),"undefined"!=typeof window)var swfobject=function(){function e(){if(!H){try{var e=D.getElementsByTagName("body")[0].appendChild(h("span"));e.parentNode.removeChild(e)}catch(t){return}H=!0;for(var n=L.length,o=0;n>o;o++)L[o]()}}function t(e){H?e():L[L.length]=e}function n(e){if(typeof R.addEventListener!=x)R.addEventListener("load",e,!1);else if(typeof D.addEventListener!=x)D.addEventListener("load",e,!1);else if(typeof R.attachEvent!=x)v(R,"onload",e);else if("function"==typeof R.onload){var t=R.onload;R.onload=function(){t(),e()}}else R.onload=e}function o(){F?r():i()}function r(){var e=D.getElementsByTagName("body")[0],t=h(E);t.setAttribute("type",A);var n=e.appendChild(t);if(n){var o=0;!function(){if(typeof n.GetVariable!=x){var r=n.GetVariable("$version");r&&(r=r.split(" ")[1].split(","),V.pv=[parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10)])}else if(10>o)return o++,void setTimeout(arguments.callee,10);e.removeChild(t),n=null,i()}()}else i()}function i(){var e=B.length;if(e>0)for(var t=0;e>t;t++){var n=B[t].id,o=B[t].callbackFn,r={success:!1,id:n};if(V.pv[0]>0){var i=y(n);if(i)if(!b(B[t].swfVersion)||V.wk&&V.wk<312)if(B[t].expressInstall&&a()){var l={};l.data=B[t].expressInstall,l.width=i.getAttribute("width")||"0",l.height=i.getAttribute("height")||"0",i.getAttribute("class")&&(l.styleclass=i.getAttribute("class")),i.getAttribute("align")&&(l.align=i.getAttribute("align"));for(var u={},d=i.getElementsByTagName("param"),f=d.length,m=0;f>m;m++)"movie"!=d[m].getAttribute("name").toLowerCase()&&(u[d[m].getAttribute("name")]=d[m].getAttribute("value"));c(l,u,n,o)}else p(i),o&&o(r);else k(n,!0),o&&(r.success=!0,r.ref=s(n),o(r))}else if(k(n,!0),o){var h=s(n);h&&typeof h.SetVariable!=x&&(r.success=!0,r.ref=h),o(r)}}}function s(e){var t=null,n=y(e);if(n&&"OBJECT"==n.nodeName)if(typeof n.SetVariable!=x)t=n;else{var o=n.getElementsByTagName(E)[0];o&&(t=o)}return t}function a(){return!X&&b("6.0.65")&&(V.win||V.mac)&&!(V.wk&&V.wk<312)}function c(e,t,n,o){X=!0,O=o||null,M={success:!1,id:n};var r=y(n);if(r){"OBJECT"==r.nodeName?(w=l(r),S=null):(w=r,S=n),e.id=P,(typeof e.width==x||!/%$/.test(e.width)&&parseInt(e.width,10)<310)&&(e.width="310"),(typeof e.height==x||!/%$/.test(e.height)&&parseInt(e.height,10)<137)&&(e.height="137"),D.title=D.title.slice(0,47)+" - Flash Player Installation";var i=V.ie&&V.win?["Active"].concat("").join("X"):"PlugIn",s="MMredirectURL="+R.location.toString().replace(/&/g,"%26")+"&MMplayerType="+i+"&MMdoctitle="+D.title;if(typeof t.flashvars!=x?t.flashvars+="&"+s:t.flashvars=s,V.ie&&V.win&&4!=r.readyState){var a=h("div");n+="SWFObjectNew",a.setAttribute("id",n),r.parentNode.insertBefore(a,r),r.style.display="none",function(){4==r.readyState?r.parentNode.removeChild(r):setTimeout(arguments.callee,10)}()}u(e,t,n)}}function p(e){if(V.ie&&V.win&&4!=e.readyState){var t=h("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(l(e),t),e.style.display="none",function(){4==e.readyState?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}()}else e.parentNode.replaceChild(l(e),e)}function l(e){var t=h("div");if(V.win&&V.ie)t.innerHTML=e.innerHTML;else{var n=e.getElementsByTagName(E)[0];if(n){var o=n.childNodes;if(o)for(var r=o.length,i=0;r>i;i++)1==o[i].nodeType&&"PARAM"==o[i].nodeName||8==o[i].nodeType||t.appendChild(o[i].cloneNode(!0))}}return t}function u(e,t,n){var o,r=y(n);if(V.wk&&V.wk<312)return o;if(r)if(typeof e.id==x&&(e.id=n),V.ie&&V.win){var i="";for(var s in e)e[s]!=Object.prototype[s]&&("data"==s.toLowerCase()?t.movie=e[s]:"styleclass"==s.toLowerCase()?i+=' class="'+e[s]+'"':"classid"!=s.toLowerCase()&&(i+=" "+s+'="'+e[s]+'"'));var a="";for(var c in t)t[c]!=Object.prototype[c]&&(a+='<param name="'+c+'" value="'+t[c]+'" />');r.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+i+">"+a+"</object>",U[U.length]=e.id,o=y(e.id)}else{var p=h(E);p.setAttribute("type",A);for(var l in e)e[l]!=Object.prototype[l]&&("styleclass"==l.toLowerCase()?p.setAttribute("class",e[l]):"classid"!=l.toLowerCase()&&p.setAttribute(l,e[l]));for(var u in t)t[u]!=Object.prototype[u]&&"movie"!=u.toLowerCase()&&d(p,u,t[u]);r.parentNode.replaceChild(p,r),o=p}return o}function d(e,t,n){var o=h("param");o.setAttribute("name",t),o.setAttribute("value",n),e.appendChild(o)}function f(e){var t=y(e);t&&"OBJECT"==t.nodeName&&(V.ie&&V.win?(t.style.display="none",function(){4==t.readyState?m(e):setTimeout(arguments.callee,10)}()):t.parentNode.removeChild(t))}function m(e){var t=y(e);if(t){for(var n in t)"function"==typeof t[n]&&(t[n]=null);t.parentNode.removeChild(t)}}function y(e){var t=null;try{t=D.getElementById(e)}catch(n){}return t}function h(e){return D.createElement(e)}function v(e,t,n){e.attachEvent(t,n),$[$.length]=[e,t,n]}function b(e){var t=V.pv,n=e.split(".");return n[0]=parseInt(n[0],10),n[1]=parseInt(n[1],10)||0,n[2]=parseInt(n[2],10)||0,t[0]>n[0]||t[0]==n[0]&&t[1]>n[1]||t[0]==n[0]&&t[1]==n[1]&&t[2]>=n[2]?!0:!1}function g(e,t,n,o){if(!V.ie||!V.mac){var r=D.getElementsByTagName("head")[0];if(r){var i=n&&"string"==typeof n?n:"screen";if(o&&(I=null,C=null),!I||C!=i){var s=h("style");s.setAttribute("type","text/css"),s.setAttribute("media",i),I=r.appendChild(s),V.ie&&V.win&&typeof D.styleSheets!=x&&D.styleSheets.length>0&&(I=D.styleSheets[D.styleSheets.length-1]),C=i}V.ie&&V.win?I&&typeof I.addRule==E&&I.addRule(e,t):I&&typeof D.createTextNode!=x&&I.appendChild(D.createTextNode(e+" {"+t+"}"))}}}function k(e,t){if(q){var n=t?"visible":"hidden";H&&y(e)?y(e).style.visibility=n:g("#"+e,"visibility:"+n)}}function T(e){var t=/[\\\"<>\.;]/,n=null!=t.exec(e);return n&&typeof encodeURIComponent!=x?encodeURIComponent(e):e}{var w,S,O,M,I,C,x="undefined",E="object",_="Shockwave Flash",j="ShockwaveFlash.ShockwaveFlash",A="application/x-shockwave-flash",P="SWFObjectExprInst",N="onreadystatechange",R=window,D=document,W=navigator,F=!1,L=[o],B=[],U=[],$=[],H=!1,X=!1,q=!0,V=function(){var e=typeof D.getElementById!=x&&typeof D.getElementsByTagName!=x&&typeof D.createElement!=x,t=W.userAgent.toLowerCase(),n=W.platform.toLowerCase(),o=/win/.test(n?n:t),r=/mac/.test(n?n:t),i=/webkit/.test(t)?parseFloat(t.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,s=!1,a=[0,0,0],c=null;if(typeof W.plugins!=x&&typeof W.plugins[_]==E)c=W.plugins[_].description,!c||typeof W.mimeTypes!=x&&W.mimeTypes[A]&&!W.mimeTypes[A].enabledPlugin||(F=!0,s=!1,c=c.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),a[0]=parseInt(c.replace(/^(.*)\..*$/,"$1"),10),a[1]=parseInt(c.replace(/^.*\.(.*)\s.*$/,"$1"),10),a[2]=/[a-zA-Z]/.test(c)?parseInt(c.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof R[["Active"].concat("Object").join("X")]!=x)try{var p=new(window[["Active"].concat("Object").join("X")])(j);p&&(c=p.GetVariable("$version"),c&&(s=!0,c=c.split(" ")[1].split(","),a=[parseInt(c[0],10),parseInt(c[1],10),parseInt(c[2],10)]))}catch(l){}return{w3:e,pv:a,wk:i,ie:s,win:o,mac:r}}();!function(){V.w3&&((typeof D.readyState!=x&&"complete"==D.readyState||typeof D.readyState==x&&(D.getElementsByTagName("body")[0]||D.body))&&e(),H||(typeof D.addEventListener!=x&&D.addEventListener("DOMContentLoaded",e,!1),V.ie&&V.win&&(D.attachEvent(N,function(){"complete"==D.readyState&&(D.detachEvent(N,arguments.callee),e())}),R==top&&!function(){if(!H){try{D.documentElement.doScroll("left")}catch(t){return void setTimeout(arguments.callee,0)}e()}}()),V.wk&&!function(){return H?void 0:/loaded|complete/.test(D.readyState)?void e():void setTimeout(arguments.callee,0)}(),n(e)))}(),function(){V.ie&&V.win&&window.attachEvent("onunload",function(){for(var e=$.length,t=0;e>t;t++)$[t][0].detachEvent($[t][1],$[t][2]);for(var n=U.length,o=0;n>o;o++)f(U[o]);for(var r in V)V[r]=null;V=null;for(var i in swfobject)swfobject[i]=null;swfobject=null})}()}return{registerObject:function(e,t,n,o){if(V.w3&&e&&t){var r={};r.id=e,r.swfVersion=t,r.expressInstall=n,r.callbackFn=o,B[B.length]=r,k(e,!1)}else o&&o({success:!1,id:e})},getObjectById:function(e){return V.w3?s(e):void 0},embedSWF:function(e,n,o,r,i,s,p,l,d,f){var m={success:!1,id:n};V.w3&&!(V.wk&&V.wk<312)&&e&&n&&o&&r&&i?(k(n,!1),t(function(){o+="",r+="";var t={};if(d&&typeof d===E)for(var y in d)t[y]=d[y];t.data=e,t.width=o,t.height=r;var h={};if(l&&typeof l===E)for(var v in l)h[v]=l[v];if(p&&typeof p===E)for(var g in p)typeof h.flashvars!=x?h.flashvars+="&"+g+"="+p[g]:h.flashvars=g+"="+p[g];if(b(i)){var T=u(t,h,n);t.id==n&&k(n,!0),m.success=!0,m.ref=T}else{if(s&&a())return t.data=s,void c(t,h,n,f);k(n,!0)}f&&f(m)})):f&&f(m)},switchOffAutoHideShow:function(){q=!1},ua:V,getFlashPlayerVersion:function(){return{major:V.pv[0],minor:V.pv[1],release:V.pv[2]}},hasFlashPlayerVersion:b,createSWF:function(e,t,n){return V.w3?u(e,t,n):void 0},showExpressInstall:function(e,t,n,o){V.w3&&a()&&c(e,t,n,o)},removeSWF:function(e){V.w3&&f(e)},createCSS:function(e,t,n,o){V.w3&&g(e,t,n,o)},addDomLoadEvent:t,addLoadEvent:n,getQueryParamValue:function(e){var t=D.location.search||D.location.hash;if(t){if(/\?/.test(t)&&(t=t.split("?")[1]),null==e)return T(t);for(var n=t.split("&"),o=0;o<n.length;o++)if(n[o].substring(0,n[o].indexOf("="))==e)return T(n[o].substring(n[o].indexOf("=")+1))}return""},expressInstallCallback:function(){if(X){var e=y(P);e&&w&&(e.parentNode.replaceChild(w,e),S&&(k(S,!0),V.ie&&V.win&&(w.style.display="block")),O&&O(M)),X=!1}}}}();!function(){if("undefined"!=typeof window&&!window.WebSocket){var e=window.console;if(e&&e.log&&e.error||(e={log:function(){},error:function(){}}),!swfobject.hasFlashPlayerVersion("10.0.0"))return void e.error("Flash Player >= 10.0.0 is required.");"file:"==location.protocol&&e.error("WARNING: web-socket-js doesn't work in file:///... URL unless you set Flash Security Settings properly. Open the page via Web server i.e. http://..."),WebSocket=function(e,t,n,o,r){var i=this;i.__id=WebSocket.__nextId++,WebSocket.__instances[i.__id]=i,i.readyState=WebSocket.CONNECTING,i.bufferedAmount=0,i.__events={},t?"string"==typeof t&&(t=[t]):t=[],setTimeout(function(){WebSocket.__addTask(function(){WebSocket.__flash.create(i.__id,e,t,n||null,o||0,r||null)})},0)},WebSocket.prototype.send=function(e){if(this.readyState==WebSocket.CONNECTING)throw"INVALID_STATE_ERR: Web Socket connection has not been established";var t=WebSocket.__flash.send(this.__id,encodeURIComponent(e));return 0>t?!0:(this.bufferedAmount+=t,!1)},WebSocket.prototype.close=function(){this.readyState!=WebSocket.CLOSED&&this.readyState!=WebSocket.CLOSING&&(this.readyState=WebSocket.CLOSING,WebSocket.__flash.close(this.__id))},WebSocket.prototype.addEventListener=function(e,t,n){e in this.__events||(this.__events[e]=[]),this.__events[e].push(t)},WebSocket.prototype.removeEventListener=function(e,t,n){if(e in this.__events)for(var o=this.__events[e],r=o.length-1;r>=0;--r)if(o[r]===t){o.splice(r,1);break}},WebSocket.prototype.dispatchEvent=function(e){for(var t=this.__events[e.type]||[],n=0;n<t.length;++n)t[n](e);var o=this["on"+e.type];o&&o(e)},WebSocket.prototype.__handleEvent=function(e){"readyState"in e&&(this.readyState=e.readyState),"protocol"in e&&(this.protocol=e.protocol);var t;if("open"==e.type||"error"==e.type)t=this.__createSimpleEvent(e.type);else if("close"==e.type)t=this.__createSimpleEvent("close");else{if("message"!=e.type)throw"unknown event type: "+e.type;var n=decodeURIComponent(e.message);t=this.__createMessageEvent("message",n)}this.dispatchEvent(t)},WebSocket.prototype.__createSimpleEvent=function(e){if(document.createEvent&&window.Event){var t=document.createEvent("Event");return t.initEvent(e,!1,!1),t}return{type:e,bubbles:!1,cancelable:!1}},WebSocket.prototype.__createMessageEvent=function(e,t){if(document.createEvent&&window.MessageEvent&&!window.opera){var n=document.createEvent("MessageEvent");return n.initMessageEvent("message",!1,!1,t,null,null,window,null),n}return{type:e,data:t,bubbles:!1,cancelable:!1}},WebSocket.CONNECTING=0,WebSocket.OPEN=1,WebSocket.CLOSING=2,WebSocket.CLOSED=3,WebSocket.__flash=null,WebSocket.__instances={},WebSocket.__tasks=[],WebSocket.__nextId=0,WebSocket.loadFlashPolicyFile=function(e){WebSocket.__addTask(function(){WebSocket.__flash.loadManualPolicyFile(e)})},WebSocket.__initialize=function(){if(!WebSocket.__flash){if(WebSocket.__swfLocation&&(window.WEB_SOCKET_SWF_LOCATION=WebSocket.__swfLocation),!window.WEB_SOCKET_SWF_LOCATION)return void e.error("[WebSocket] set WEB_SOCKET_SWF_LOCATION to location of WebSocketMain.swf");var t=document.createElement("div");t.id="webSocketContainer",t.style.position="absolute",WebSocket.__isFlashLite()?(t.style.left="0px",t.style.top="0px"):(t.style.left="-100px",t.style.top="-100px");var n=document.createElement("div");n.id="webSocketFlash",t.appendChild(n),document.body.appendChild(t),swfobject.embedSWF(WEB_SOCKET_SWF_LOCATION,"webSocketFlash","1","1","10.0.0",null,null,{hasPriority:!0,swliveconnect:!0,allowScriptAccess:"always"},null,function(t){t.success||e.error("[WebSocket] swfobject.embedSWF failed")})}},WebSocket.__onFlashInitialized=function(){setTimeout(function(){WebSocket.__flash=document.getElementById("webSocketFlash"),WebSocket.__flash.setCallerUrl(location.href),WebSocket.__flash.setDebug(!!window.WEB_SOCKET_DEBUG);for(var e=0;e<WebSocket.__tasks.length;++e)WebSocket.__tasks[e]();WebSocket.__tasks=[]},0)},WebSocket.__onFlashEvent=function(){return setTimeout(function(){try{for(var t=WebSocket.__flash.receiveEvents(),n=0;n<t.length;++n)WebSocket.__instances[t[n].webSocketId].__handleEvent(t[n])}catch(o){e.error(o)}},0),!0},WebSocket.__log=function(t){e.log(decodeURIComponent(t))},WebSocket.__error=function(t){e.error(decodeURIComponent(t))},WebSocket.__addTask=function(e){WebSocket.__flash?e():WebSocket.__tasks.push(e)},WebSocket.__isFlashLite=function(){if(!window.navigator||!window.navigator.mimeTypes)return!1;var e=window.navigator.mimeTypes["application/x-shockwave-flash"];return e&&e.enabledPlugin&&e.enabledPlugin.filename&&e.enabledPlugin.filename.match(/flashlite/i)?!0:!1},window.WEB_SOCKET_DISABLE_AUTO_INITIALIZATION||(window.addEventListener?window.addEventListener("load",function(){WebSocket.__initialize()},!1):window.attachEvent("onload",function(){WebSocket.__initialize()}))}}(),function(e,t,n){function o(e){e&&(t.Transport.apply(this,arguments),this.sendBuffer=[])}function r(){}e.XHR=o,t.util.inherit(o,t.Transport),o.prototype.open=function(){return this.socket.setBuffer(!1),this.onOpen(),this.get(),this.setCloseTimeout(),this},o.prototype.payload=function(e){for(var n=[],o=0,r=e.length;r>o;o++)n.push(t.parser.encodePacket(e[o]));this.send(t.parser.encodePayload(n))},o.prototype.send=function(e){return this.post(e),this},o.prototype.post=function(e){function t(){4==this.readyState&&(this.onreadystatechange=r,i.posting=!1,200==this.status?i.socket.setBuffer(!1):i.onClose())}function o(){this.onload=r,i.socket.setBuffer(!1)}var i=this;this.socket.setBuffer(!0),this.sendXHR=this.request("POST"),n.XDomainRequest&&this.sendXHR instanceof XDomainRequest?this.sendXHR.onload=this.sendXHR.onerror=o:this.sendXHR.onreadystatechange=t,this.sendXHR.send(e)},o.prototype.close=function(){return this.onClose(),this},o.prototype.request=function(e){var n=t.util.request(this.socket.isXDomain()),o=t.util.query(this.socket.options.query,"t="+ +new Date);if(n.open(e||"GET",this.prepareUrl()+o,!0),"POST"==e)try{n.setRequestHeader?n.setRequestHeader("Content-type","text/plain;charset=UTF-8"):n.contentType="text/plain"}catch(r){}return n},o.prototype.scheme=function(){return this.socket.options.secure?"https":"http"},o.check=function(e,o){try{var r=t.util.request(o),i=n.XDomainRequest&&r instanceof XDomainRequest,s=e&&e.options&&e.options.secure?"https:":"http:",a=n.location&&s!=n.location.protocol;if(r&&(!i||!a))return!0}catch(c){}return!1},o.xdomainCheck=function(e){return o.check(e,!0)}}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,t){function n(e){t.Transport.XHR.apply(this,arguments)}e.htmlfile=n,t.util.inherit(n,t.Transport.XHR),n.prototype.name="htmlfile",n.prototype.get=function(){this.doc=new(window[["Active"].concat("Object").join("X")])("htmlfile"),this.doc.open(),this.doc.write("<html></html>"),this.doc.close(),this.doc.parentWindow.s=this;var e=this.doc.createElement("div");e.className="socketio",this.doc.body.appendChild(e),this.iframe=this.doc.createElement("iframe"),e.appendChild(this.iframe);var n=this,o=t.util.query(this.socket.options.query,"t="+ +new Date);this.iframe.src=this.prepareUrl()+o,t.util.on(window,"unload",function(){n.destroy()})},n.prototype._=function(e,t){this.onData(e);try{var n=t.getElementsByTagName("script")[0];n.parentNode.removeChild(n)}catch(o){}},n.prototype.destroy=function(){if(this.iframe){try{this.iframe.src="about:blank"}catch(e){}this.doc=null,this.iframe.parentNode.removeChild(this.iframe),this.iframe=null,CollectGarbage()}},n.prototype.close=function(){return this.destroy(),t.Transport.XHR.prototype.close.call(this)},n.check=function(e){if("undefined"!=typeof window&&["Active"].concat("Object").join("X")in window)try{var n=new(window[["Active"].concat("Object").join("X")])("htmlfile");return n&&t.Transport.XHR.check(e)}catch(o){}return!1},n.xdomainCheck=function(){return!1},t.transports.push("htmlfile")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t,n){function o(){t.Transport.XHR.apply(this,arguments)}function r(){}e["xhr-polling"]=o,t.util.inherit(o,t.Transport.XHR),t.util.merge(o,t.Transport.XHR),o.prototype.name="xhr-polling",o.prototype.heartbeats=function(){return!1},o.prototype.open=function(){var e=this;return t.Transport.XHR.prototype.open.call(e),!1},o.prototype.get=function(){function e(){4==this.readyState&&(this.onreadystatechange=r,200==this.status?(i.onData(this.responseText),i.get()):i.onClose())}function t(){this.onload=r,this.onerror=r,i.retryCounter=1,i.onData(this.responseText),i.get()}function o(){i.retryCounter++,!i.retryCounter||i.retryCounter>3?i.onClose():i.get()}if(this.isOpen){var i=this;this.xhr=this.request(),n.XDomainRequest&&this.xhr instanceof XDomainRequest?(this.xhr.onload=t,this.xhr.onerror=o):this.xhr.onreadystatechange=e,this.xhr.send(null)}},o.prototype.onClose=function(){if(t.Transport.XHR.prototype.onClose.call(this),this.xhr){this.xhr.onreadystatechange=this.xhr.onload=this.xhr.onerror=r;try{this.xhr.abort()}catch(e){}this.xhr=null}},o.prototype.ready=function(e,n){var o=this;t.util.defer(function(){n.call(o)})},t.transports.push("xhr-polling")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,t,n){function o(e){t.Transport["xhr-polling"].apply(this,arguments),this.index=t.j.length;var n=this;t.j.push(function(e){n._(e)})}var r=n.document&&"MozAppearance"in n.document.documentElement.style;e["jsonp-polling"]=o,t.util.inherit(o,t.Transport["xhr-polling"]),o.prototype.name="jsonp-polling",o.prototype.post=function(e){function n(){o(),r.socket.setBuffer(!1)}function o(){r.iframe&&r.form.removeChild(r.iframe);try{s=document.createElement('<iframe name="'+r.iframeId+'">')}catch(e){s=document.createElement("iframe"),s.name=r.iframeId}s.id=r.iframeId,r.form.appendChild(s),r.iframe=s}var r=this,i=t.util.query(this.socket.options.query,"t="+ +new Date+"&i="+this.index);if(!this.form){var s,a=document.createElement("form"),c=document.createElement("textarea"),p=this.iframeId="socketio_iframe_"+this.index;a.className="socketio",a.style.position="absolute",a.style.top="0px",a.style.left="0px",a.style.display="none",a.target=p,a.method="POST",a.setAttribute("accept-charset","utf-8"),c.name="d",a.appendChild(c),document.body.appendChild(a),this.form=a,this.area=c}this.form.action=this.prepareUrl()+i,o(),this.area.value=t.JSON.stringify(e);try{this.form.submit()}catch(l){}this.iframe.attachEvent?s.onreadystatechange=function(){"complete"==r.iframe.readyState&&n()}:this.iframe.onload=n,this.socket.setBuffer(!0)},o.prototype.get=function(){var e=this,n=document.createElement("script"),o=t.util.query(this.socket.options.query,"t="+ +new Date+"&i="+this.index);this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),n.async=!0,n.src=this.prepareUrl()+o,n.onerror=function(){e.onClose()};var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(n,i),this.script=n,r&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},o.prototype._=function(e){return this.onData(e),this.isOpen&&this.get(),this},o.prototype.ready=function(e,n){var o=this;return r?void t.util.load(function(){n.call(o)}):n.call(this)},o.check=function(){return"document"in n},o.xdomainCheck=function(){return!0},t.transports.push("jsonp-polling")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function(){return io}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}()}).call(exports,__webpack_require__(14)(module))},function(e,t){function n(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=n,n.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(e){this.ms=e},n.prototype.setMax=function(e){this.max=e},n.prototype.setJitter=function(e){this.jitter=e}},function(e,t,n){"use strict";function o(e){r.verifyOptions(e,"type to"),r.verifyParamValid("type",e.type,u()),-1!==e.type.indexOf("custom")&&(r.verifyOptions(e,"content sendToOnlineUsersOnly"),
r.verifyParamType("sendToOnlineUsersOnly",e.sendToOnlineUsersOnly,"boolean"),this.attach=e.content,this.sendToOnlineUsersOnly=e.sendToOnlineUsersOnly?"0":"1","undefined"!=typeof e.apnsText&&(this.apnsText=""+e.apnsText)),this.time=+new Date,this.to=e.to,this.type=c[e.type],this.idClient=r.guid()}var r=n(6),i=n(8),s=n(15),a=n(20),c={applyTeam:0,rejectApply:1,teamInvite:2,rejectInvite:3,memberUpdate:4,customP2p:100,customTeam:101},p={0:"applyTeam",1:"rejectApply",2:"teamInvite",3:"rejectInvite",4:"memberUpdate",100:"customP2p",101:"customTeam"},l=function(e){var t={time:+e.time,to:e.to,type:p[e.type]};if("undefined"!=typeof e.from&&(t.from=e.from),"undefined"!=typeof e.idServer&&(t.idServer=+e.idServer),"undefined"!=typeof e.idClient&&(t.idClient=e.idClient),"undefined"!=typeof e.ps&&(t.ps=e.ps),-1===t.type.indexOf("custom")){if("undefined"!=typeof e.attach){t.attach={};var n=JSON.parse(e.attach);"undefined"!=typeof n.tinfo&&(t.attach.team=s.reverse(i.unserialize(n.tinfo,"team"))),"undefined"!=typeof n.tlist&&(t.attach.member=a.reverse(i.unserialize(n.tlist,"teamMember")))}}else"customTeam"===t.type&&(t.to=+t.to),t.content=e.attach,"undefined"!=typeof e.sendToOnlineUsersOnly&&(t.sendToOnlineUsersOnly="0"===e.sendToOnlineUsersOnly),"undefined"!=typeof e.apnsText&&(t.apnsText=e.apnsText);return t},u=function(){return Object.keys(c)};e.exports={SystemMessage:o,reverse:l}},function(e,t,n){"use strict";function o(e){r.verifyOptions(e,"teamId"),this.teamId=e.teamId,"undefined"!=typeof e.account&&(this.account=e.account),"undefined"!=typeof e.nickInTeam&&(this.nickInTeam=e.nickInTeam)}var r=n(6),i={0:"normal",1:"owner",2:"manager"},s=function(e){var t=e;return"undefined"!=typeof t.teamId&&(t.teamId=+t.teamId),"undefined"!=typeof t.type&&(t.type=i[t.type]),"undefined"!=typeof t.active&&(t.active="1"===t.active),"undefined"!=typeof t.valid&&(t.valid="1"===t.valid),"undefined"!=typeof t.joinTime&&(t.joinTime=+t.joinTime),"undefined"!=typeof t.updateTime&&(t.updateTime=+t.updateTime),t};e.exports={TeamMember:o,reverse:s}},function(e,t,n){var o="1.3.0",r="https://lbs.netease.im/lbs/webconf.jsp",i=n(22),s={};if("undefined"==typeof o)throw new Error("please inject version");if(s.version=o,"undefined"==typeof r)throw new Error("please inject lbsUrl");s.lbsUrl=r,s.sdkVersion=12,s.protocolVersion=1,s.lbsMaxRetryCount=1,s.reconnectionDelay=1e3,s.reconnectionDelayMax=8e3,s.socketTimeout=6e3,s.socketServerUrls=[],s.socketServerUrlsBackup=[],s.socketServerUrl="https://weblink.netease.im:9092",s.getSocketServerUrl=function(e){var t=s.lbsUrl+"?k="+e.appKey+"&id="+e.account+"&sv="+s.sdkVersion+"&pv="+s.protocolVersion;i({method:"GET",cors:!0,url:t},function(t,n,o){t?e.done(t):(o=JSON.parse(o),o.common.link.forEach(function(e){s.socketServerUrls.push(s.formatSocketServerUrl(e))}),o.common["link.default"].forEach(function(e){e=s.formatSocketServerUrl(e),-1===s.socketServerUrls.indexOf(e)&&s.socketServerUrls.push(e)}),s.socketServerUrls=s.socketServerUrls.slice(0,5),s.socketServerUrlsBackup=s.socketServerUrls.slice(0),e.done(null,s.getNextSocketServerUrl()))})},s.formatSocketServerUrl=function(e){return-1===e.indexOf("https")?"https://"+e:e},s.getNextSocketServerUrl=function(){var e=s.socketServerUrls.shift();return e},s.restoreSocketServerUrls=function(){s.socketServerUrls=s.socketServerUrlsBackup.slice(0)},s.fileServerUrl="https://nos.netease.com/",e.exports=s},function(e,t,n){"use strict";function o(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function r(e,t){function n(){4===u.readyState&&p()}function i(){var e=void 0;if(u.response?e=u.response:"text"!==u.responseType&&u.responseType||(e=u.responseText||u.responseXML),k)try{e=JSON.parse(e)}catch(t){}return e}function s(e){clearTimeout(m),e instanceof Error||(e=new Error(""+(e||"unknown"))),e.statusCode=0,t(e,l)}function p(){if(!f){var n;clearTimeout(m),n=e.useXDR&&void 0===u.status?200:1223===u.status?204:u.status;var o=l,r=null;0!==n?(o={body:i(),statusCode:n,method:h,headers:{},url:y,rawRequest:u},u.getAllResponseHeaders&&(o.headers=c(u.getAllResponseHeaders()))):r=new Error("Internal XMLHttpRequest Error"),t(r,o,o.body)}}var l={body:void 0,headers:{},statusCode:0,method:h,url:y,rawRequest:u};if("string"==typeof e&&(e={uri:e}),e=e||{},"undefined"==typeof t)throw new Error("callback argument missing");t=a(t);var u=e.xhr||null;u||(u=e.cors||e.useXDR?new r.XDomainRequest:new r.XMLHttpRequest);var d,f,m,y=u.url=e.uri||e.url,h=u.method=e.method||"GET",v=e.body||e.data,b=u.headers=e.headers||{},g=!!e.sync,k=!1;if("json"in e&&(k=!0,b.accept||b.Accept||(b.Accept="application/json"),"GET"!==h&&"HEAD"!==h&&(b["Content-Type"]="application/json",v=JSON.stringify(e.json))),u.onreadystatechange=n,u.onload=p,u.onerror=s,u.onprogress=function(){},u.ontimeout=s,u.open(h,y,!g,e.username,e.password),g||(u.withCredentials=!!e.withCredentials),!g&&e.timeout>0&&(m=setTimeout(function(){f=!0,u.abort("timeout"),s()},e.timeout)),u.setRequestHeader)for(d in b)b.hasOwnProperty(d)&&u.setRequestHeader(d,b[d]);else if(e.headers&&!o(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(u.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(u),u.send(v),u}function i(){}var s=n(23),a=n(24),c=n(25);e.exports=r,r.XMLHttpRequest=s.XMLHttpRequest||i,r.XDomainRequest="withCredentials"in new r.XMLHttpRequest?r.XMLHttpRequest:s.XDomainRequest},function(e,t){(function(t){e.exports="undefined"!=typeof window?window:"undefined"!=typeof t?t:"undefined"!=typeof self?self:{}}).call(t,function(){return this}())},function(e,t){function n(e){var t=!1;return function(){return t?void 0:(t=!0,e.apply(this,arguments))}}e.exports=n,n.proto=n(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return n(this)},configurable:!0})})},function(e,t,n){var o=n(26),r=n(27),i=function(e){return"[object Array]"===Object.prototype.toString.call(e)};e.exports=function(e){if(!e)return{};var t={};return r(o(e).split("\n"),function(e){var n=e.indexOf(":"),r=o(e.slice(0,n)).toLowerCase(),s=o(e.slice(n+1));"undefined"==typeof t[r]?t[r]=s:i(t[r])?t[r].push(s):t[r]=[t[r],s]}),t}},function(e,t){function n(e){return e.replace(/^\s*|\s*$/g,"")}t=e.exports=n,t.left=function(e){return e.replace(/^\s*/,"")},t.right=function(e){return e.replace(/\s*$/,"")}},function(e,t,n){function o(e,t,n){if(!a(t))throw new TypeError("iterator must be a function");arguments.length<3&&(n=this),"[object Array]"===c.call(e)?r(e,t,n):"string"==typeof e?i(e,t,n):s(e,t,n)}function r(e,t,n){for(var o=0,r=e.length;r>o;o++)p.call(e,o)&&t.call(n,e[o],o,e)}function i(e,t,n){for(var o=0,r=e.length;r>o;o++)t.call(n,e.charAt(o),o,e)}function s(e,t,n){for(var o in e)p.call(e,o)&&t.call(n,e[o],o,e)}var a=n(28);e.exports=o;var c=Object.prototype.toString,p=Object.prototype.hasOwnProperty},function(e,t){function n(e){var t=o.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)}e.exports=n;var o=Object.prototype.toString},function(e,t,n){"use strict";function o(e){this.options=r.copy(e),r.verifyOptions(e,"url fileInput fileName"),e.fileInput=r.verifyFileInput(e.fileInput),e.type&&r.verifyFileType(e.type),e.timeout?r.verifyParamType("timeout",e.timeout,"number"):e.timeout=6e5,r.verifyFileUploadCallback(e),a?p.call(this,e):u.call(this,e)}var r=n(6),i=n(30),s=n(7),a="undefined"!=typeof window.FormData,c=104857600;o.prototype.cancel=function(){a?l.call(this):d.call(this)};var p=function(e){var t=new window.FormData,n=e.fileName,o=e.type?r.filterFiles(e.fileInput.files,e.type):[].slice.call(e.fileInput.files,0);if(!o||!o.length)return void e.uploaddone(s.newWrongFileTypeError("请选择"+e.type+"类型的文件"));var i=e.fileInput.files[0].size;if(i>c)return void e.uploaddone(s.newFileTooLargeError("文件大小超过100M"));t.append(n,o[0]),e.params&&Object.keys(e.params).forEach(function(n){t.append(n,e.params[n])});var a=new window.XMLHttpRequest;this.xhr=a,a.upload.addEventListener("progress",function(t){t.lengthComputable&&t.loaded<=t.total&&(t.percentage=Math.floor(1e4*t.loaded/t.total)/100,e.uploadprogress({total:t.total,loaded:t.loaded,percentage:t.percentage,percentageText:t.percentage+"%"}))}.bind(this)),a.upload.addEventListener("load",function(t){t.percentage=100,e.uploadprogress({total:t.total,loaded:t.loaded,percentage:t.percentage})}.bind(this)),a.upload.addEventListener("error",function(t){e.uploaddone(s.newNetworkError())}.bind(this)),a.upload.addEventListener("abort",function(t){e.uploadcancel()}.bind(this)),a.upload.addEventListener("timeout",function(t){e.uploadtimeout(s.newTimeoutError())}.bind(this)),a.addEventListener("load",function(t){var n,o,r,i,a=t.target.responseText;switch(a&&(n=JSON.parse(a)),t.target.status){case 200:e.uploaddone(null,n);break;default:n=n||{},o=n.Error||{},r=o.Code||"unknown",i=o.Message||"未知错误",e.uploaddone(new s(r+"("+i+")",r))}}.bind(this)),a.open("POST",e.url),a.timeout=e.timeout,e.headers&&(r.verifyParamType("headers",e.headers,"object"),Object.keys(e.headers).forEach(function(t){a.setRequestHeader(t,e.headers[t])})),a.send(t)},l=function(){this.xhr.abort()},u=function(e){this.iframe=new i(e)},d=function(){this.iframe.cancel(),this.options.uploadcancel()};e.exports=o},function(e,t,n){"use strict";function o(e){this.options=r.copy(e),r.verifyOptions(e,"url fileInput fileName");var t=i.html2node('<form style="display:none;"></form>');this.form=t,p++;var n="iframe-"+p;c[n]=this;var o=i.html2node('<iframe src="'+l+'" name="'+n+'"></iframe>');this.iframe=o,this.onIframeAddedCallback=m.bind(this,e),s.addEventListener(o,"load",this.onIframeAddedCallback),d(),t.appendChild(o),window.document.body.appendChild(t)}var r=n(6),i=n(31),s=n(32),a=n(7),c={},p=0,l="javascript:false;",u="NEJ-UPLOAD-RESULT:",d=function(){var e=!1;return function(){e||(e=!0,s.addEventListener(window,"message",f))}}(),f=function(e){var t=e.data;if(0===t.indexOf(u)){t=JSON.parse(t.replace(u,""));var n=c[t.key];n&&(delete c[t.key],n.onData(decodeURIComponent(t.result)))}},m=function(e){var t=this.form,n=this.iframe;s.removeEventListener(n,"load",this.onIframeAddedCallback),this.onIframeLoadedCallback=y.bind(this),s.addEventListener(n,"load",this.onIframeLoadedCallback),t.target=n.name;var o=-1===e.url.indexOf("?")?"?":"&";t.action=e.url+o+"_proxy_=form",t.method="POST";var r=e.fileInput,a=r.cloneNode(!0);if(r.parentNode.insertBefore(a,r),r.name=e.fileName,t.appendChild(r),t.enctype="multipart/form-data",t.encoding="multipart/form-data",r.setAttribute("form",""),r.removeAttribute("form"),e.params){var c=Object.keys(e.params);c.forEach(function(n){var o=i.html2node('<input type="hidden"/>');o.name=n,o.value=e.params[n],t.appendChild(o)})}t.submit(),r.name=a.name,r.setAttribute("form",a.getAttribute("form")),a.parentNode.replaceChild(r,a)},y=function(){var e,t=this.iframe,n=this.form;try{if(e=t.contentDocument||t.contentWindow.document,!e||!e.firstChild)throw new a("不能获取跨域Iframe的内容","Cross_Origin_Iframe")}catch(o){e=void 0}if(e){var r=e.body.textContent||e.body.innerText;this.onData(r)}n.appendChild(i.html2node('<iframe src="'+l+'"></iframe>')),window.setTimeout(function(){n.parentNode.removeChild(n)},0)};o.prototype.onData=function(e){var t,n,o,r;t=JSON.parse(e),t.Error?(t=t||{},n=t.Error||{},o=n.Code||"unknown",r=n.Message||"未知错误",this.options.uploaddone(new a(o+"("+r+")",o))):this.options.uploaddone(null,t)},o.prototype.cancel=function(){var e=this.form,t=this.iframe;t&&(s.removeEventListener(t,"load",this.onIframeLoadedCallback),t.src=l),e&&e.parentNode.removeChild(e)},e.exports=o},function(e,t){"use strict";var n={};n.html2node=function(e){var t=window.document.createElement("div");t.innerHTML=e;var n,o,r=[];if(t.children)for(n=0,o=t.children.length;o>n;n++)r.push(t.children[n]);else for(n=0,o=t.childNodes.length;o>n;n++){var i=t.childNodes[n];1===i.nodeType&&r.push(i)}return r.length>1?t:r[0]},e.exports=n},function(e,t){"use strict";var n={addEventListener:function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)},removeEventListener:function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n)}};e.exports=n},function(e,t){"use strict";e.exports=function(e,t){for(var n in t)e[n]=t[n]}}])});